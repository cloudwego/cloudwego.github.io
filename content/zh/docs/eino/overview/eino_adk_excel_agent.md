---
Description: ""
date: "2025-11-14"
lastmod: ""
tags: []
title: ç”¨ Eino ADK æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª AI æ™ºèƒ½ä½“ï¼šä» Excel Agent å®æˆ˜å¼€å§‹
weight: 4
---

## ä» Excel Agent è¯¦è§£ Eino ADK

æœ¬æ–‡å°†ä¼šå‘æ‚¨ä»‹ç»å¦‚ä½•åˆ©ç”¨ **Eino ADK(Agent Development Kit)** æ„å»ºä¸€ä¸ªå¼ºå¤§çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œå¾€æœŸ Eino ADK ä»‹ç»é“¾æ¥ï¼š[Eino ADKï¼šä¸€æ–‡æå®š AI Agent æ ¸å¿ƒè®¾è®¡æ¨¡å¼ï¼Œä» 0 åˆ° 1 æ­å»ºæ™ºèƒ½ä½“ç³»ç»Ÿ](https://mp.weixin.qq.com/s/ffGjlDEzEzroo8w6knlLqw)

ç¤ºä¾‹ä»¥ Excel Agent è¿™ä¸ªå®é™…ä¸šåŠ¡åœºæ™¯ä¸ºåŸºç¡€ï¼ŒExcel Agent æ˜¯ä¸€ä¸ªèƒ½å¤Ÿâ€œå¬æ‡‚ä½ çš„è¯ã€çœ‹æ‡‚ä½ çš„è¡¨æ ¼ã€å†™å‡ºå¹¶æ‰§è¡Œä»£ç â€çš„æ™ºèƒ½åŠ©æ‰‹ã€‚å®ƒæŠŠå¤æ‚çš„ Excel å¤„ç†å·¥ä½œæ‹†è§£ä¸ºæ¸…æ™°çš„æ­¥éª¤ï¼Œé€šè¿‡è‡ªåŠ¨è§„åˆ’ã€å·¥å…·è°ƒç”¨ä¸ç»“æœæ ¡éªŒï¼Œç¨³å®šå®Œæˆå„é¡¹ Excel æ•°æ®å¤„ç†ä»»åŠ¡ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä» Excel Agent çš„å®Œæ•´æ¶æ„ä¸åŠŸèƒ½å‡ºå‘ï¼Œå‘æ‚¨å±•ç¤ºè¯¥ Agent æ˜¯å¦‚ä½•é€šè¿‡ Eino ADK é€æ­¥æ­å»ºçš„ï¼Œè¿›è€Œæ·±å…¥æµ…å‡ºçš„ç†è§£ Eino ADK çš„æ ¸å¿ƒè®¾è®¡ç‰¹ç‚¹ï¼ŒåŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹ Eino ADKï¼Œå‘æ„å»ºè‡ªå®šä¹‰æ™ºèƒ½ä½“ä¸ AI åº”ç”¨ç³»ç»Ÿæ›´è¿›ä¸€æ­¥ã€‚

æœ¬ç¤ºä¾‹å®Œæ•´ä»£ç ä½äº [Github](https://github.com/cloudwego/eino-examples/tree/main/adk/multiagent/integration-excel-agent)ï¼Œæ‚¨å¯ä»¥éšæ—¶æµè§ˆä¸ä¸‹è½½ã€‚

### Excel Agent æ˜¯ä»€ä¹ˆï¼Ÿ

Excel Agent æ˜¯ä¸€ä¸ªâ€œçœ‹å¾—æ‡‚ Excel çš„æ™ºèƒ½åŠ©æ‰‹â€ï¼Œå®ƒå…ˆæŠŠé—®é¢˜æ‹†è§£æˆæ­¥éª¤ï¼Œå†ä¸€æ­¥æ­¥æ‰§è¡Œå¹¶æ ¡éªŒç»“æœã€‚å®ƒèƒ½ç†è§£ç”¨æˆ·é—®é¢˜ä¸ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ï¼Œæå‡ºå¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆç³»ç»Ÿå‘½ä»¤ã€ç”Ÿæˆå¹¶è¿è¡Œ Python ä»£ç ã€ç½‘ç»œæŸ¥è¯¢ç­‰ç­‰ï¼‰å®Œæˆä»»åŠ¡ã€‚

Excel Agent æ•´ä½“æ˜¯åŸºäº Eino ADK å®ç°çš„ Multi-Agent ç³»ç»Ÿï¼Œå®Œæ•´æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<a href="/img/eino/JTjGwKheGhTZrhbCIgZciClgnab.png" target="_blank"><img src="/img/eino/JTjGwKheGhTZrhbCIgZciClgnab.png" width="100%" /></a>

Excel Agent å†…éƒ¨åŒ…å«çš„å‡ ä¸ª Agent åŠŸèƒ½åˆ†åˆ«ä¸ºï¼š

- **Planner**ï¼šåˆ†æç”¨æˆ·è¾“å…¥ï¼Œæ‹†è§£ç”¨æˆ·é—®é¢˜ä¸ºå¯æ‰§è¡Œçš„è®¡åˆ’
- **Executor**ï¼šæ­£ç¡®æ‰§è¡Œå½“å‰è®¡åˆ’ä¸­çš„é¦–ä¸ªæ­¥éª¤
- **CodeAgent**ï¼šæ¥æ”¶æ¥è‡ª Executor çš„æŒ‡ä»¤ï¼Œè°ƒç”¨å¤šç§å·¥å…·ï¼ˆä¾‹å¦‚è¯»å†™æ–‡ä»¶ï¼Œè¿è¡Œ python ä»£ç ç­‰ï¼‰å®Œæˆä»»åŠ¡
- **WebSearchAgent**ï¼šæ¥æ”¶æ¥è‡ª Executor çš„æŒ‡ä»¤ï¼Œè¿›è¡Œç½‘ç»œæœç´¢
- **Replanner**ï¼šæ ¹æ® Executor æ‰§è¡Œçš„ç»“æœå’Œç°æœ‰è§„åˆ’ï¼Œå†³å®šç»§ç»­æ‰§è¡Œã€è°ƒæ•´è§„åˆ’æˆ–å®Œæˆæ‰§è¡Œ
- **ReportAgent**ï¼šæ ¹æ®è¿è¡Œè¿‡ç¨‹ä¸ç»“æœï¼Œç”Ÿæˆæ€»ç»“æ€§è´¨çš„æŠ¥å‘Š

### Excel Agent çš„å…¸å‹ä½¿ç”¨åœºæ™¯

åœ¨çœŸå®ä¸šåŠ¡é‡Œï¼Œä½ å¯ä»¥æŠŠ Excel Agent å½“æˆä¸€ä½â€œExcel ä¸“å®¶ + è‡ªåŠ¨åŒ–å·¥ç¨‹å¸ˆâ€ã€‚å½“ä½ äº¤ä»˜ä¸€ä¸ªåŸå§‹è¡¨æ ¼å’Œç›®æ ‡æè¿°ï¼Œå®ƒä¼šç»™å‡ºæ–¹æ¡ˆå¹¶å®Œæˆæ‰§è¡Œï¼š

- **æ•°æ®æ¸…ç†ä¸æ ¼å¼åŒ–**ï¼šä»ä¸€ä¸ªåŒ…å«å¤§é‡æ•°æ®çš„ Excel æ–‡ä»¶ä¸­å®Œæˆå»é‡ã€ç©ºå€¼å¤„ç†ã€æ—¥æœŸæ ¼å¼æ ‡å‡†åŒ–æ“ä½œã€‚
- **æ•°æ®åˆ†æä¸æŠ¥å‘Šç”Ÿæˆ**ï¼šä»é”€å”®æ•°æ®ä¸­æå–æ¯æœˆçš„é”€å”®æ€»é¢ï¼Œèšåˆç»Ÿè®¡ã€é€è§†ï¼Œæœ€ç»ˆç”Ÿæˆå¹¶å¯¼å‡ºå›¾è¡¨æŠ¥å‘Šã€‚
- **è‡ªåŠ¨åŒ–é¢„ç®—è®¡ç®—**ï¼šæ ¹æ®ä¸åŒéƒ¨é—¨çš„é¢„ç®—ç”³è¯·ï¼Œè‡ªåŠ¨è®¡ç®—æ€»é¢„ç®—å¹¶ç”Ÿæˆéƒ¨é—¨é¢„ç®—åˆ†é…è¡¨ã€‚
- **æ•°æ®åŒ¹é…ä¸åˆå¹¶**ï¼šå°†å¤šä¸ªä¸åŒæ¥æºçš„å®¢æˆ·ä¿¡æ¯è¡¨è¿›è¡ŒåŒ¹é…åˆå¹¶ï¼Œç”Ÿæˆå®Œæ•´çš„å®¢æˆ·ä¿¡æ¯æ•°æ®åº“ã€‚

Excel Agent çš„å®Œæ•´è¿è¡ŒåŠ¨çº¿ä¸ºï¼š

<a href="/img/eino/C7J2wMDQNhDCHfbPYsIcgw8Yn9g.png" target="_blank"><img src="/img/eino/C7J2wMDQNhDCHfbPYsIcgw8Yn9g.png" width="100%" /></a>

> ğŸ’¡
> **æ ¸å¿ƒæ”¶ç›Š**ï¼š
>
> - **æ›´å°‘çš„äººå·¥æ“ä½œ**ï¼ŒæŠŠå¤æ‚ç¹ççš„ Excel å¤„ç†å·¥ä½œäº¤ç»™ Agent è‡ªåŠ¨å®Œæˆã€‚
> - **æ›´ç¨³å®šçš„äº§å‡ºè´¨é‡**ï¼Œé€šè¿‡â€œè§„åˆ’â€”æ‰§è¡Œâ€”åæ€â€é—­ç¯å‡å°‘æ¼é¡¹ä¸é”™è¯¯ã€‚
> - **æ›´å¼ºçš„å¯æ‰©å±•æ€§**ï¼Œå„ Agent ç‹¬ç«‹æ„å»ºï¼Œä½è€¦åˆåˆ©äºè¿­ä»£æ›´æ–°ã€‚

Excel Agent æ—¢å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå­ Agentï¼Œé›†æˆåœ¨ä¸€ä¸ªå¤åˆçš„å¤šä¸“å®¶ç³»ç»Ÿä¸­ï¼Œç”±å¤–éƒ¨è·¯ç”±åˆ°æ­¤ Agent ä¸Šï¼Œè§£å†³ excel é¢†åŸŸç›¸å…³çš„é—®é¢˜ã€‚

ä¸‹é¢æˆ‘ä»¬å°†é€æ­¥æ‹†è§£ Excel Agentï¼Œæ·±å…¥äº†è§£ Eino ADK çš„æ ¸å¿ƒè®¾è®¡ç‰¹ç‚¹ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨è¿™äº›ç‰¹ç‚¹æ„å»ºé«˜æ•ˆã€çµæ´»çš„ AI åº”ç”¨ç³»ç»Ÿã€‚

### ChatModelAgentï¼šä¸ LLM äº¤äº’çš„åŸºçŸ³

`ChatModelAgent` æ˜¯ Eino ADK ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒé¢„æ„å»ºçš„ Agentï¼Œå†…éƒ¨ä½¿ç”¨äº† [ReAct](https://react-lm.github.io/) æ¨¡å¼ï¼ˆä¸€ç§è®©æ¨¡å‹â€˜æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿâ€™çš„é“¾å¼æ¨ç†æ¨¡å¼ï¼‰ï¼š

<a href="/img/eino/SviabfhOUoGC1TxrucAckWkmnqg.png" target="_blank"><img src="/img/eino/SviabfhOUoGC1TxrucAckWkmnqg.png" width="100%" /></a>

`ChatModelAgent` æ—¨åœ¨è®© ChatModel è¿›è¡Œæ˜¾å¼çš„ã€ä¸€æ­¥ä¸€æ­¥çš„â€œæ€è€ƒâ€ï¼Œç»“åˆæ€è€ƒè¿‡ç¨‹é©±åŠ¨è¡ŒåŠ¨ï¼Œè§‚æµ‹å†å²æ€è€ƒè¿‡ç¨‹ä¸è¡ŒåŠ¨ç»“æœç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥çš„æ€è€ƒä¸è¡ŒåŠ¨ï¼Œæœ€ç»ˆè§£å†³å¤æ‚é—®é¢˜ï¼š

- è°ƒç”¨ ChatModelï¼ˆReasonï¼‰
- LLM è¿”å›å·¥å…·è°ƒç”¨è¯·æ±‚ï¼ˆActionï¼‰
- ChatModelAgent æ‰§è¡Œå·¥å…·ï¼ˆActï¼‰
- å°†å·¥å…·ç»“æœè¿”å›ç»™ LLMï¼ˆObservationï¼‰ï¼Œç»“åˆä¹‹å‰çš„ä¸Šä¸‹æ–‡ç»§ç»­ç”Ÿæˆï¼Œç›´åˆ°æ¨¡å‹åˆ¤æ–­ä¸éœ€è¦è°ƒç”¨å·¥å…·åç»“æŸ

<a href="/img/eino/XI1Kw4OUNhx1pubKkE1cJk6xnVg.png" target="_blank"><img src="/img/eino/XI1Kw4OUNhx1pubKkE1cJk6xnVg.png" width="100%" /></a>

åœ¨ Excel Agent ä¸­ï¼Œæ¯ä¸ª Agent çš„æ ¸å¿ƒéƒ½æ˜¯è¿™æ ·ä¸€ä¸ª `ChatModelAgent`ï¼Œä»¥ Executor è¿è¡Œã€è¯»å–ç”¨æˆ·è¾“å…¥è¡¨æ ¼çš„å¤´ä¿¡æ¯ã€‘è¿™ä¸ªæ­¥éª¤ä¸ºä¾‹ ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿå®Œæ•´çš„è¿è¡Œè¿‡ç¨‹æ¥ç†è§£ ReAct æ¨¡å¼åœ¨ `ChatModelAgent` ä¸­çš„è¡¨ç°ï¼š

1. Executorï¼šç»è¿‡åˆ¤æ–­ï¼Œå°†ä»»åŠ¡è½¬äº¤ç»™ CodeAgent è¿è¡Œ
2. CodeAgentï¼šæ¥æ”¶åˆ°ä»»åŠ¡ã€è¯»å–ç”¨æˆ·è¾“å…¥è¡¨æ ¼çš„å¤´ä¿¡æ¯ã€‘
   1. **Think-1**ï¼šä¸Šä¸‹æ–‡æœªæä¾›å·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œéœ€è¦æŸ¥çœ‹
   2. **Act-1**: è°ƒç”¨ Bash å·¥å…·ï¼Œls æŸ¥çœ‹å·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
   3. **Think-2**: æ‰¾åˆ°äº†ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶ï¼Œåˆ¤æ–­éœ€è¦ç¼–å†™ Python ä»£ç è¯»å– xlsx è¡¨æ ¼çš„é¦–è¡Œ
   4. **Act-2**: è°ƒç”¨ PythonRunner å·¥å…·ï¼Œä¹¦å†™ä»£ç å¹¶è¿è¡Œï¼Œè·å–è¿è¡Œç»“æœ
   5. **Think-3**: è·å–åˆ°äº† xlsx é¦–è¡Œï¼Œåˆ¤æ–­ä»»åŠ¡å®Œæˆ
3. è¿è¡Œå®Œæˆï¼Œå°†è¡¨æ ¼å¤´ä¿¡æ¯è¿”å›ç»™ Executor

### Plan-Execute Agentï¼šåŸºäºã€Œè§„åˆ’-æ‰§è¡Œ-åæ€ã€çš„å¤šæ™ºèƒ½ä½“åä½œæ¡†æ¶

Plan-Execute Agent æ˜¯ Eino ADK ä¸­ä¸€ç§åŸºäºã€Œè§„åˆ’-æ‰§è¡Œ-åæ€ã€èŒƒå¼çš„å¤šæ™ºèƒ½ä½“åä½œæ¡†æ¶ï¼Œæ—¨åœ¨è§£å†³å¤æ‚ä»»åŠ¡çš„åˆ†æ­¥æ‹†è§£ã€æ‰§è¡Œä¸åŠ¨æ€è°ƒæ•´é—®é¢˜ã€‚å®ƒé€šè¿‡ **Plannerï¼ˆè§„åˆ’å™¨ï¼‰**ã€**Executorï¼ˆæ‰§è¡Œå™¨ï¼‰** å’Œ **Replannerï¼ˆé‡è§„åˆ’å™¨ï¼‰** ä¸‰ä¸ªæ ¸å¿ƒæ™ºèƒ½ä½“çš„ååŒå·¥ä½œï¼Œå®ç°ä»»åŠ¡çš„ç»“æ„åŒ–è§„åˆ’ã€å·¥å…·è°ƒç”¨æ‰§è¡Œã€è¿›åº¦è¯„ä¼°ä¸åŠ¨æ€ replanningï¼Œæœ€ç»ˆè¾¾æˆç”¨æˆ·ç›®æ ‡ï¼š

```go
// å®Œæ•´ä»£ç : https://github.com/cloudwego/eino/blob/main/adk/prebuilt/planexecute/plan_execute.go

// NewPlanner creates a new planner agent based on the provided configuration.
func NewPlanner(_ context.Context, cfg *PlannerConfig) (adk.Agent, error)

// NewExecutor creates a new executor agent.
func NewExecutor(ctx context.Context, cfg *ExecutorConfig) (adk.Agent, error)

// NewReplanner creates a new replanner agent.
func NewReplanner(_ context.Context, cfg *ReplannerConfig) (adk.Agent, error)

// New creates a new plan-execute-replan agent with the given configuration.
func New(ctx context.Context, cfg *Config) (adk.Agent, error)
```

<a href="/img/eino/SjhmwZUNzhch0rb8SdUcwotpnaf.png" target="_blank"><img src="/img/eino/SjhmwZUNzhch0rb8SdUcwotpnaf.png" width="100%" /></a>

è€Œ Excel Agent çš„æ ¸å¿ƒèƒ½åŠ›æ°å¥½ä¸ºã€è§£å†³ç”¨æˆ·åœ¨ excel é¢†åŸŸçš„é—®é¢˜ã€‘ï¼Œä¸è¯¥æ™ºèƒ½ä½“åä½œæ¡†æ¶å®šä½ä¸€è‡´ï¼š

- **è§„åˆ’è€…ï¼ˆPlannerï¼‰**ï¼šæ˜ç¡®ç›®æ ‡ï¼Œè‡ªåŠ¨æ‹†è§£å¯æ‰§è¡Œæ­¥éª¤
- **æ‰§è¡Œè€…ï¼ˆExecutorï¼‰**ï¼šè°ƒç”¨å·¥å…·ï¼ˆExcel è¯»å–ã€ç³»ç»Ÿå‘½ä»¤ã€Python ä»£ç ï¼‰å®Œæˆè§„åˆ’ä¸­çš„æ¯ä¸€ä¸ªè¯¦ç»†æ­¥éª¤
- **åæ€è€…ï¼ˆReplannerï¼‰**ï¼šæ ¹æ®æ‰§è¡Œè¿›åº¦å†³å®šç»§ç»­ã€è°ƒæ•´è§„åˆ’æˆ–ç»“æŸ

Planner å’Œ Replanner ä¼šå°†ç”¨æˆ·æ¨¡ç³Šçš„æŒ‡ä»¤æ‹†è§£ä¸ºæ¸…æ™°çš„ã€å¯æ‰§è¡Œçš„æ­¥éª¤æ¸…å•ï¼Œå³åŒ…å«å¤šä¸ªæ­¥éª¤ï¼ˆStepï¼‰çš„è®¡åˆ’ï¼ˆPlanï¼‰ï¼ŒEino ADK ä¸ºæ­¤æä¾›äº†çµæ´»çš„ Plan æ¥å£å®šä¹‰ï¼Œæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ Plan ç»“æ„ä¸ç»†èŠ‚ï¼š

```go
type Plan interface {
    // FirstStep returns the first step to be executed in the plan.
    FirstStep() string
    // Marshaler serializes the Plan into JSON.
    // The resulting JSON can be used in prompt templates.
    json.Marshaler
    // Unmarshaler deserializes JSON content into the Plan.
    // This processes output from structured chat models or tool calls into the Plan structure.
    json.Unmarshaler
}
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¡†æ¶ä¼šä½¿ç”¨å†…ç½®çš„ Plan ç»“æ„ä½œä¸ºå…œåº•é…ç½®ï¼Œä¾‹å¦‚ä¸‹é¢å°±æ˜¯ Excel Agent äº§ç”Ÿçš„ä¸€ä¸ªå®Œæ•´è¿è¡Œè®¡åˆ’ï¼š

```sql
### ä»»åŠ¡è®¡åˆ’
- [x] 1. Read the contents of 'æ¨¡æ‹Ÿå‡ºé¢˜.csv' from the working directory into a pandas DataFrame.
- [x] 2. Identify the question type (e.g., multiple-choice, short-answer) for each row in the DataFrame.
- [x] 3. For non-short-answer questions, restructure the data to place question, answer, explanation, and options in the same row.
- [x] 4. For short-answer questions, merge the answer content into the explanation column and ensure question and merged explanation are in the same row.
- [x] 5. Verify that all processed rows have question, answer (where applicable), explanation, and options (where applicable) in a single row with consistent formatting.
- [x] 6. Generate a cleaned report presenting the formatted questions with all relevant components (question, answer, explanation, options) in unified rows.
```

### Workflow Agentsï¼šå¯æ§çš„å¤š Agent è¿è¡Œæµæ°´çº¿

Excel Agent ä¸­ï¼Œå­˜åœ¨ä¸€äº›éœ€è¦æŒ‰ç…§ç‰¹å®šé¡ºåºè¿è¡Œ agent çš„æƒ…å†µï¼š

1. **é¡ºåºè¿è¡Œ**ï¼šå…ˆè¿è¡Œ Plannerï¼Œå†è¿è¡Œ Executor å’Œ Replannerï¼›Planner åªè¿è¡Œä¸€æ¬¡ã€‚
2. **å¾ªç¯è¿è¡Œ**ï¼šExecutor å’Œ Replanner éœ€è¦æŒ‰éœ€å¾ªç¯è¿è¡Œå¤šæ¬¡ï¼Œæ¯æ¬¡å¾ªç¯è¿è¡Œéƒ½æ˜¯å…ˆè¿è¡Œ Executor åè¿è¡Œ Replanner
3. **é¡ºåºè¿è¡Œ**ï¼šPlan-Executor æ•´ä½“è¿è¡Œå®Œåï¼Œå›ºå®šè¿è¡Œä¸€æ¬¡ ReportAgent è¿›è¡Œæ€»ç»“ã€‚

å¯¹äºè¿™äº›æ‹¥æœ‰å›ºå®šæ‰§è¡Œæµç¨‹çš„åœºæ™¯ï¼ŒEino ADK æä¾›äº†ä¸‰ç§æµç¨‹ç¼–æ’æ–¹å¼ï¼ŒååŠ©ç”¨æˆ·å¿«é€Ÿæ­å»ºå¯æ§çš„å·¥ä½œæµï¼š

- **SequentialAgent**ï¼šæŒ‰ç…§é…ç½®ä¸­æä¾›çš„é¡ºåºï¼Œä¾æ¬¡æ‰§è¡Œä¸€ç³»åˆ—å­ Agentã€‚æ¯ä¸ªå­ Agent æ‰§è¡Œå®Œæˆåï¼Œå…¶è¾“å‡ºä¼šé€šè¿‡ History æœºåˆ¶ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå­ Agentï¼Œå½¢æˆä¸€ä¸ªçº¿æ€§çš„æ‰§è¡Œé“¾ã€‚

  ```go
  import github.com/cloudwego/eino/adk

  // ä¾æ¬¡æ‰§è¡Œ åˆ¶å®šç ”ç©¶è®¡åˆ’ -> æœç´¢èµ„æ–™ -> æ’°å†™æŠ¥å‘Š
  sequential := adk.NewSequentialAgent(ctx, &adk.SequentialAgentConfig{
      Name: "research_pipeline",
      SubAgents: []adk.Agent{
          planAgent,    // åˆ¶å®šç ”ç©¶è®¡åˆ’
          searchAgent,  // æœç´¢èµ„æ–™
          writeAgent,   // æ’°å†™æŠ¥å‘Š
      },
  })
  ```

<a href="/img/eino/LuyNwCiyHhoL4Wb48XHcsHS6nrf.png" target="_blank"><img src="/img/eino/LuyNwCiyHhoL4Wb48XHcsHS6nrf.png" width="100%" /></a>

- **LoopAgent**ï¼šé‡å¤æ‰§è¡Œé…ç½®çš„å­ Agent åºåˆ—ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–æŸä¸ªå­ Agent äº§ç”Ÿ ExitActionï¼Œæ¯æ¬¡è¿­ä»£çš„ç»“æœéƒ½ä¼šç´¯ç§¯ï¼Œåç»­è¿­ä»£çš„è¾“å…¥å¯ä»¥è®¿é—®æ‰€æœ‰å†å²ä¿¡æ¯ã€‚LoopAgent åŸºäº SequentialAgent å®ç°ã€‚

  ```go
  import github.com/cloudwego/eino/adk

  // å¾ªç¯æ‰§è¡Œ 5 æ¬¡ï¼Œæ¯æ¬¡é¡ºåºä¸ºï¼šåˆ†æå½“å‰çŠ¶æ€ -> æå‡ºæ”¹è¿›æ–¹æ¡ˆ -> éªŒè¯æ”¹è¿›æ•ˆæœ
  loop := adk.NewLoopAgent(ctx, &adk.LoopAgentConfig{
      Name: "iterative_optimization",
      SubAgents: []adk.Agent{
          analyzeAgent,  // åˆ†æå½“å‰çŠ¶æ€
          improveAgent,  // æå‡ºæ”¹è¿›æ–¹æ¡ˆ
          validateAgent, // éªŒè¯æ”¹è¿›æ•ˆæœ
      },
      MaxIterations: 5,
  })
  ```

<a href="/img/eino/JCOUw5vAJhghRPbakhec9wolnfc.png" target="_blank"><img src="/img/eino/JCOUw5vAJhghRPbakhec9wolnfc.png" width="100%" /></a>

- **ParallelAgent**ï¼šå…è®¸å¤šä¸ªå­ Agent åŸºäºç›¸åŒçš„è¾“å…¥ä¸Šä¸‹æ–‡å¹¶å‘æ‰§è¡Œã€‚æ‰€æœ‰å­ Agent æ¥æ”¶ç›¸åŒçš„åˆå§‹è¾“å…¥ï¼Œå„è‡ªåœ¨ç‹¬ç«‹çš„ goroutineï¼ˆGo è¯­è¨€ä¸­ä¸€ç§è½»é‡çº§çš„å¹¶å‘æ‰§è¡Œå•å…ƒï¼‰ è¿è¡Œï¼Œæœ€ç»ˆæ”¶é›†æ‰€æœ‰å­ Agent çš„æ‰§è¡Œç»“æœå¹¶æŒ‰é¡ºåºè¾“å‡ºåˆ° `AsyncIterator` ä¸­ã€‚

  ```go
  import github.com/cloudwego/eino/adk

  // å¹¶å‘æ‰§è¡Œ æƒ…æ„Ÿåˆ†æ + å…³é”®è¯æå– + å†…å®¹æ‘˜è¦
  parallel := adk.NewParallelAgent(ctx, &adk.ParallelAgentConfig{
      Name: "multi_analysis",
      SubAgents: []adk.Agent{
          sentimentAgent,  // æƒ…æ„Ÿåˆ†æ
          keywordAgent,    // å…³é”®è¯æå–
          summaryAgent,    // å†…å®¹æ‘˜è¦
      },
  })
  ```

<a href="/img/eino/UL4Zw6Rj7hXg2rbNHLAcPhZOnrn.png" target="_blank"><img src="/img/eino/UL4Zw6Rj7hXg2rbNHLAcPhZOnrn.png" width="100%" /></a>

### Agent æŠ½è±¡ï¼šçµæ´»å®šä¹‰ Agent çš„åŸºç¡€

Eino ADK çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç®€æ´è€Œå¼ºå¤§çš„ Agent æ¥å£ï¼Œæ¯ä¸ª Agent éƒ½æœ‰æ˜ç¡®çš„èº«ä»½ï¼ˆNameï¼‰ã€æ¸…æ™°çš„èŒè´£ï¼ˆDescriptionï¼‰å’Œæ ‡å‡†åŒ–çš„æ‰§è¡Œæ–¹å¼ï¼ˆRunï¼‰ï¼Œä¸º Agent ä¹‹é—´çš„å‘ç°ä¸è°ƒç”¨æä¾›äº†åŸºç¡€ã€‚æ— è®ºæ˜¯ç®€å•çš„é—®ç­”æœºå™¨äººï¼Œè¿˜æ˜¯å¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡å¤„ç†ç³»ç»Ÿï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªç»Ÿä¸€çš„æ¥å£åŠ ä»¥å®ç°ã€‚

- **ç»Ÿä¸€çš„ Agent æŠ½è±¡**ï¼šADK æä¾›çš„é¢„æ„å»º Agentï¼ˆChatModelAgentï¼ŒPlan-Execute Agentï¼ŒWorkflow Agentsï¼‰éƒ½éµå¾ªè¯¥æ¥å£å®šä¹‰ã€‚æ‚¨ä¹Ÿå¯ä»¥åŸºäºè¯¥æ¥å£ï¼Œä¹¦å†™è‡ªå®šä¹‰ Agentï¼Œå®Œæˆå®šåˆ¶åŒ–éœ€æ±‚ã€‚

  ```go
  type Agent interface {
      Name(ctx context.Context) string
      Description(ctx context.Context) string
      Run(ctx context.Context, input *AgentInput, options ...AgentRunOption) *AsyncIterator[*AgentEvent]
  }
  ```
- **æ ‡å‡†åŒ–è¾“å…¥**ï¼šAgent é€šå¸¸ä»¥ LLM ä¸ºæ ¸å¿ƒï¼Œå› æ­¤ Eino ADK å®šä¹‰çš„ Agent çš„è¾“å…¥ä¸ LLM æ¥æ”¶çš„è¾“å…¥ä¸€è‡´ï¼š

  ```go
  type AgentInput struct {
      Messages        []_Message_
  _    _EnableStreaming bool
  }

  type Message = *schema.Message // *schema.Message æ˜¯æ¨¡å‹è¾“å…¥è¾“å‡ºçš„ç»“æ„å®šä¹‰
  ```
- **å¼‚æ­¥äº‹ä»¶é©±åŠ¨è¾“å‡º**ï¼šAgent çš„è¾“å‡ºæ˜¯ä¸€ä¸ª AgentEvent çš„å¼‚æ­¥è¿­ä»£å™¨ï¼Œå…¶ä¸­çš„ AgentEvent è¡¨ç¤º Agent åœ¨å…¶è¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ ¸å¿ƒäº‹ä»¶æ•°æ®ã€‚å…¶ä¸­åŒ…å«äº† Agent çš„å…ƒä¿¡æ¯ã€è¾“å‡ºã€è¡Œä¸ºå’ŒæŠ¥é”™ä¿¡æ¯ï¼š

  ```go
  type AgentEvent struct {
      AgentName string    // äº§ç”Ÿ Event çš„ Agent åç§°ï¼ˆæ¡†æ¶è‡ªåŠ¨å¡«å……ï¼‰

      RunPath []RunStep   // åˆ°è¾¾å½“å‰ Agent çš„å®Œæ•´è¿è¡Œè½¨è¿¹ï¼ˆæ¡†æ¶è‡ªåŠ¨å¡«å……ï¼‰

      Output *AgentOutput // Agent è¾“å‡ºæ¶ˆæ¯å†…å®¹

      Action *AgentAction // Agent åŠ¨ä½œäº‹ä»¶å†…å®¹

      Err error           // Agent æŠ¥é”™
  }

  type AgentOutput struct {
      MessageOutput *MessageVariant // æ¨¡å‹æ¶ˆæ¯è¾“å‡ºå†…å®¹

      CustomizedOutput any          // è‡ªå®šä¹‰è¾“å‡ºå†…å®¹
  }

  type MessageVariant struct {
      IsStreaming bool            // æ˜¯å¦ä¸ºæµå¼è¾“å‡º

      Message       Message        // éæµå¼æ¶ˆæ¯è¾“å‡º
      MessageStream MessageStream  // æµå¼æ¶ˆæ¯è¾“å‡º

      Role schema.RoleType         // æ¶ˆæ¯è§’è‰²
      ToolName string              // å·¥å…·åç§°
  }

  type AgentAction struct {
      Exit bool                               // Agent é€€å‡º

      Interrupted *InterruptInfo              // Agent ä¸­æ–­

      TransferToAgent *TransferToAgentAction  // Agent è·³è½¬

      CustomizedAction any                    // è‡ªå®šä¹‰ Agent åŠ¨ä½œ
  }
  ```

å¼‚æ­¥è¿­ä»£å™¨å…è®¸ Agent åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„æ—¶åˆ»å‘è¿­ä»£å™¨å‘é€æ¶ˆæ¯ï¼ˆAgent è°ƒç”¨æ¨¡å‹ç»“æœã€å·¥å…·è¿è¡Œç»“æœã€ä¸­é—´çŠ¶æ€ç­‰ç­‰ï¼‰ï¼ŒåŒæ—¶è°ƒç”¨æ–¹ä»¥ä¸€ç§æœ‰åºã€é˜»å¡çš„æ–¹å¼æ¶ˆè´¹è¿™ä¸€ç³»åˆ—äº‹ä»¶ï¼š

```go
iter := myAgent.Run(ctx, "hello") // get AsyncIterator

for {
    event, ok := iter.Next()
    if !ok {
        break
    }
    // handle event
}
```

### Agent åä½œï¼šéšè—åœ¨ Agent åçš„æ•°æ®ä¼ é€’

Excel Agent æ¶æ„å›¾ä¸­çš„èŠ‚ç‚¹ä»£è¡¨æ¯ä¸ªå…·ä½“çš„ Agentï¼Œè¾¹ä»£è¡¨äº†æ•°æ®æµé€šä¸ä»»åŠ¡è½¬ç§»ã€‚åœ¨æ„å»ºå¤š Agent ç³»ç»Ÿæ—¶ï¼Œè®©ä¸åŒ Agent ä¹‹é—´é«˜æ•ˆã€å‡†ç¡®åœ°å…±äº«ä¿¡æ¯è‡³å…³é‡è¦ã€‚

è¿™äº›ä¿¡æ¯ä¸ä»…åŒ…å« Agent çš„è¾“å…¥è¾“å‡ºï¼Œè¿˜æœ‰å…¨å±€çš„ã€éƒ¨åˆ†å¯è§çš„ç§ç§é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š

- Executor æ‰§è¡Œéœ€è¦ä» Planner / Replanner æ‹¿åˆ°ä¸€ä¸ªç»“æ„åŒ–çš„ã€å¯è¢«æ‹†åˆ†ä¸ºè¯¦ç»†æ­¥éª¤ï¼ˆStepï¼‰çš„è®¡åˆ’ï¼ˆPlanï¼‰ï¼Œè€Œéä¸€æ®µéç»“æ„åŒ–çš„ LLM åŸå§‹è¾“å‡ºæ¶ˆæ¯ã€‚
- ReportAgent éœ€è¦æ‹¿åˆ°å®Œæ•´çš„è¿è¡Œè®¡åˆ’ã€è¿è¡Œè¿‡ç¨‹ä¸è¿è¡Œäº§ç‰©æ‰èƒ½æ­£ç¡®äº§ç”ŸæŠ¥å‘Šã€‚

Eino ADK åŒ…å«ä¸¤ç§åŸºç¡€çš„æ•°æ®ä¼ é€’æœºåˆ¶ï¼š

- **History**ï¼šæ¯ä¸€ä¸ª Agent äº§ç”Ÿçš„ AgentEvent éƒ½ä¼šè¢«ä¿å­˜åˆ°è¿™ä¸ªéšè—çš„ History ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªæ–° Agent æ—¶ History ä¸­çš„ AgentEvent ä¼šè¢«è½¬æ¢å¹¶æ‹¼æ¥åˆ° AgentInput ä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶ä»– Agent çš„ Assistant æˆ– Tool Messageï¼Œè¢«è½¬æ¢ä¸º User Messageï¼Œè¿™ç›¸å½“äºåœ¨å‘Šè¯‰å½“å‰çš„ LLMï¼šâ€œåˆšæ‰ï¼Œ Agent_A è°ƒç”¨äº† some_tool ï¼Œè¿”å›äº† some_result ã€‚ç°åœ¨ï¼Œè½®åˆ°ä½ æ¥å†³ç­–äº†ã€‚â€ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå…¶ä»– Agent çš„è¡Œä¸ºè¢«å½“ä½œäº†æä¾›ç»™å½“å‰ Agent çš„â€œå¤–éƒ¨ä¿¡æ¯â€æˆ–â€œäº‹å®é™ˆè¿°â€ï¼Œè€Œä¸æ˜¯å®ƒè‡ªå·±çš„è¡Œä¸ºï¼Œä»è€Œé¿å…äº† LLM çš„ä¸Šä¸‹æ–‡æ··ä¹±ã€‚

<a href="/img/eino/HyrlwkG2Bh2tAfbDPRUcJjoXnje.png" target="_blank"><img src="/img/eino/HyrlwkG2Bh2tAfbDPRUcJjoXnje.png" width="100%" /></a>

- **å…±äº« Session**ï¼šå•æ¬¡è¿è¡Œè¿‡ç¨‹ä¸­æŒç»­å­˜åœ¨çš„ KV å­˜å‚¨ï¼Œç”¨äºæ”¯æŒè·¨ Agent çš„çŠ¶æ€ç®¡ç†å’Œæ•°æ®å…±äº«ï¼Œä¸€æ¬¡è¿è¡Œä¸­çš„ä»»ä½• Agent å¯ä»¥åœ¨ä»»ä½•æ—¶é—´è¯»å†™ SessionValuesã€‚ä»¥ Plan-Execute Agent æ¨¡å¼ä¸ºä¾‹ï¼ŒPlanner ç”Ÿæˆé¦–ä¸ªè®¡åˆ’å¹¶å†™å…¥ Sessionï¼›Executor ä» Session è¯»å–è®¡åˆ’å¹¶æ‰§è¡Œï¼›Replanner ä» Session è¯»å–å½“å‰è®¡åˆ’åï¼Œç»“åˆè¿è¡Œç»“æœï¼Œå°†æ›´æ–°åçš„è®¡åˆ’å†™å› Session è¦†ç›–å½“å‰çš„è®¡åˆ’ã€‚

  ```go
  // Agent å†…è·å–å…¨éƒ¨ SessionValues
  func GetSessionValues(ctx context.Context) map[string]any

  // Agent å†…æŒ‡å®š key è·å– SessionValues ä¸­çš„å€¼
  func GetSessionValue(ctx context.Context, key string) (any, bool)

  // Agent å†…æ·»åŠ  SessionValues
  func AddSessionValue(ctx context.Context, key string, value any)

  // Agent å†…æ‰¹é‡æ·»åŠ  SessionValues
  func AddSessionValues(ctx context.Context, kvs map[string]any)

  // WithSessionValues åœ¨ Agent è¿è¡Œå‰ç”±å¤–éƒ¨æ³¨å…¥ SessionValues
  func WithSessionValues(v map[string]any) AgentRunOption
  ```

<a href="/img/eino/SSmjw7ooshk8rybm87XchHPtn7K.png" target="_blank"><img src="/img/eino/SSmjw7ooshk8rybm87XchHPtn7K.png" width="100%" /></a>

é™¤äº†å®Œå–„çš„ Agent é—´æ•°æ®ä¼ é€’æœºåˆ¶ï¼ŒEino ADK ä»å®è·µå‡ºå‘ï¼Œæä¾›äº†å¤šç§ Agent åä½œæ¨¡å¼ï¼š

- **é¢„è®¾ Agent è¿è¡Œé¡ºåºï¼ˆWorkflowï¼‰**ï¼šä»¥ä»£ç ä¸­é¢„è®¾å¥½çš„æµç¨‹è¿è¡Œï¼Œ Agent çš„æ‰§è¡Œé¡ºåºæ˜¯äº‹å…ˆç¡®å®šã€å¯é¢„æµ‹çš„ã€‚å¯¹åº” Workflow Agents ç« èŠ‚æåˆ°çš„ä¸‰ç§èŒƒå¼ã€‚
- **ç§»äº¤è¿è¡Œï¼ˆTransferï¼‰**ï¼šæºå¸¦æœ¬ Agent è¾“å‡ºç»“æœä¸Šä¸‹æ–‡ï¼Œå°†ä»»åŠ¡ç§»äº¤è‡³å­ Agent ç»§ç»­å¤„ç†ã€‚é€‚ç”¨äºæ™ºèƒ½ä½“åŠŸèƒ½å¯ä»¥æ¸…æ™°çš„åˆ’åˆ†è¾¹ç•Œä¸å±‚çº§çš„åœºæ™¯ï¼Œå¸¸ç»“åˆ ChatModelAgent ä½¿ç”¨ï¼Œé€šè¿‡ LLM çš„ç”Ÿæˆç»“æœè¿›è¡ŒåŠ¨æ€è·¯ç”±ã€‚ç»“æ„ä¸Šï¼Œä»¥æ­¤æ–¹å¼è¿›è¡Œåä½œçš„ä¸¤ä¸ª Agent ç§°ä¸ºçˆ¶å­ Agentï¼š

<a href="/img/eino/R2CBwqMnbhjTQJbOAJQcyojLnIe.png" target="_blank"><img src="/img/eino/R2CBwqMnbhjTQJbOAJQcyojLnIe.png" width="100%" /></a>

```go
// è®¾ç½®çˆ¶å­ Agent å…³ç³»
func SetSubAgents(ctx context.Context, agent Agent, subAgents []Agent) (Agent, error)

// æŒ‡å®šç›®æ ‡ Agent åç§°ï¼Œæ„é€  Transfer Event
func NewTransferToAgentAction(destAgentName string) *AgentAction
```

- **æ˜¾å¼è°ƒç”¨ï¼ˆToolCallï¼‰**ï¼šå°† Agent è§†ä¸ºå·¥å…·è¿›è¡Œè°ƒç”¨ï¼Œé€‚ç”¨äº Agent è¿è¡Œä»…éœ€è¦æ˜ç¡®æ¸…æ™°çš„å‚æ•°è€Œéå®Œæ•´è¿è¡Œä¸Šä¸‹æ–‡çš„åœºæ™¯ã€‚å¸¸ç»“åˆ ChatModelAgentï¼Œå°† Agent ä½œä¸ºå·¥å…·è¿è¡Œåå°†ç»“æœè¿”å›ç»™ ChatModel ç»§ç»­å¤„ç†ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒToolCall åŒæ ·æ”¯æŒè°ƒç”¨ç¬¦åˆå·¥å…·æ¥å£æ„é€ çš„ã€ä¸å« Agent çš„æ™®é€šå·¥å…·ã€‚

<a href="/img/eino/SnmTwoOFGh2ZMHbDVoNcH2eInsQ.png" target="_blank"><img src="/img/eino/SnmTwoOFGh2ZMHbDVoNcH2eInsQ.png" width="100%" /></a>

```go
// å°† Agent è½¬æ¢ä¸º Tool
func NewAgentTool(_ context.Context, agent Agent, options ...AgentToolOption) tool.BaseTool
```

## Excel Agent ç¤ºä¾‹è¿è¡Œ

### é…ç½®ç¯å¢ƒä¸è¾“å…¥è¾“å‡ºè·¯å¾„

- ç¯å¢ƒå˜é‡ï¼šExcel Agent è¿è¡Œä¾èµ–çš„å®Œæ•´ç¯å¢ƒå˜é‡å¯å‚è€ƒé¡¹ç›® READMEã€‚
- è¿è¡Œè¾“å…¥ï¼šåŒ…æ‹¬ä¸€æ®µç”¨æˆ·éœ€æ±‚æè¿°å’Œå¾…å¤„ç†çš„ä¸€ç³»åˆ—æ–‡ä»¶ï¼Œå…¶ä¸­ï¼š

  - `main.go` ä¸­é¦–è¡Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„éœ€æ±‚æè¿°ï¼Œå¯è‡ªè¡Œä¿®æ”¹ï¼š

    ```go
    func main() {
        // query := schema.UserMessage("ç»Ÿè®¡é™„ä»¶æ–‡ä»¶ä¸­æ¨èçš„å°è¯´åç§°åŠæ¨èæ¬¡æ•°ï¼Œå¹¶å°†ç»“æœå†™åˆ°æ–‡ä»¶ä¸­ã€‚å‡¡æ˜¯å¸¦æœ‰ã€Šã€‹å†…å®¹éƒ½æ˜¯å°è¯´åç§°ï¼Œå½¢æˆè¡¨æ ¼ï¼Œè¡¨å¤´ä¸ºå°è¯´åç§°å’Œæ¨èæ¬¡æ•°ï¼ŒåŒåå°è¯´åªåˆ—ä¸€è¡Œï¼Œæ¨èæ¬¡æ•°ç›¸åŠ ")
        // query := schema.UserMessage("è¯»å–æ¨¡æ‹Ÿå‡ºé¢˜.csv ä¸­çš„å†…å®¹ï¼Œè§„èŒƒæ ¼å¼å°†é¢˜ç›®ã€ç­”æ¡ˆã€è§£æã€é€‰é¡¹æ”¾åœ¨åŒä¸€è¡Œï¼Œç®€ç­”é¢˜åªæŠŠç­”æ¡ˆå†™å…¥è§£æå³å¯")
        query := schema.UserMessage("è¯·å¸®æˆ‘å°† question.csv è¡¨æ ¼ä¸­çš„ç¬¬ä¸€åˆ—æå–åˆ°ä¸€ä¸ªæ–°çš„ csv ä¸­")
    }
    ```
  - `adk/multiagent/integration-excel-agent/playground/input` ä¸ºé»˜è®¤çš„é™„ä»¶è¾“å…¥è·¯å¾„ï¼Œé™„ä»¶è¾“å…¥è·¯å¾„æ”¯æŒé…ç½®ï¼Œå‚è€ƒ READMEã€‚
  - `adk/multiagent/integration-excel-agent/playground/test_data` è·¯å¾„ä¸‹æä¾›äº†å‡ ä¸ªç¤ºä¾‹æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å°†æ–‡ä»¶å¤åˆ¶åˆ°é™„ä»¶è¾“å…¥è·¯å¾„ä¸‹æ¥è¿›è¡Œæµ‹è¯•è¿è¡Œï¼š

    ```go
    % tree adk/multiagent/integration-excel-agent/playground/test_data
    adk/multiagent/integration-excel-agent/playground/test_data
    â”œâ”€â”€ questions.csv
    â”œâ”€â”€ æ¨èå°è¯´.txt
    â””â”€â”€ æ¨¡æ‹Ÿå‡ºé¢˜.csv

    1 directory, 3 files
    ```
- è¿è¡Œè¾“å‡ºï¼šExcel Agent è¾“å…¥çš„é™„ä»¶ã€è¿è¡Œçš„ä¸­é—´äº§ç‰©ä¸æœ€ç»ˆç»“æœéƒ½ä¼šæ”¾ç½®åœ¨å·¥ä½œè·¯å¾„ä¸‹ï¼š`adk/multiagent/integration-excel-agent/playground/${uuid}`ï¼Œè¾“å‡ºè·¯å¾„æ”¯æŒé…ç½®ï¼Œå‚è€ƒ READMEã€‚

### æŸ¥çœ‹è¿è¡Œç»“æœ

Excel Agent å•æ¬¡è¿è¡Œä¼šåœ¨è¾“å‡ºè·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹å®Œæˆä»»åŠ¡ï¼Œè¿è¡Œæ—¶äº§ç”Ÿçš„ä¸­é—´äº§ç‰©ä¸æœ€ç»ˆç»“æœéƒ½ä¼šå†™åˆ°è¯¥ç›®å½•ä¸‹ã€‚

ä»¥ `è¯·å¸®æˆ‘å°† question.csv è¡¨æ ¼ä¸­çš„ç¬¬ä¸€åˆ—æå–åˆ°ä¸€ä¸ªæ–°çš„ csv ä¸­` è¿™ä¸ªä»»åŠ¡ä¸ºä¾‹ï¼Œè¿è¡Œå®Œæˆååœ¨å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶åŒ…å«ï¼š

<a href="/img/eino/ActebkYfUo7bCwxPk8ocOLEOnsf.png" target="_blank"><img src="/img/eino/ActebkYfUo7bCwxPk8ocOLEOnsf.png" width="100%" /></a>

1. åŸå§‹è¾“å…¥ï¼šä»è¾“å…¥è·¯å¾„è·å–åˆ°çš„ `question.csv`
2. Planner / Replanner ç»™å‡ºçš„è¿è¡Œè®¡åˆ’ï¼š`plan.md`

   ```go
   ### ä»»åŠ¡è®¡åˆ’
   - [x] 1. {"desc":"Read the 'questions.csv' file into a pandas DataFrame."}
   - [x] 2. Save the extracted first column to a new CSV file.
   ```
3. Executor ä¸­çš„ CodeAgent ä¹¦å†™çš„ä»£ç ï¼š`$uuid.py`

   ```go
   import pandas as pd

   df = pd.read_csv('questions.csv')
   first_column = df.iloc[:, _0_]
   first_column.to_csv('extracted_first_column.csv', index=_False_)
   ```
4. è¿è¡Œä¸­é—´äº§ç‰©ï¼š`extracted_first_column.csv` å’Œ `first_column.csv`

   ```go
   type
   multiple-choice
   ...
   short-answer
   ```
5. æœ€ç»ˆæŠ¥å‘Šï¼š`final_report.json`

   ```json
   {
     "is_success": true,
     "result": "Successfully extracted the first column from questions.csv and saved it to first_column.csv.",
     "files": [
       {
         "path": "/User/user/go/src/github.com/cloudwego/eino-examples/adk/multiagent/integration-excel-agent/playground/00f118af-4bd8-42f7-8d11-71f2801218bd/first_column.csv",
         "desc": "A CSV file containing only the first column data from the original questions.csv."
       }
     ]
   }
   ```

### è¿è¡Œè¿‡ç¨‹è¾“å‡º

Excel Agent ä¼šå°†æ¯ä¸ªæ­¥éª¤çš„è¿è¡Œç»“æœè¾“å‡ºåˆ°æ—¥å¿—ä¸­ã€‚ä¸‹é¢ä»ä»¥ `è¯·å¸®æˆ‘å°† question.csv è¡¨æ ¼ä¸­çš„ç¬¬ä¸€åˆ—æå–åˆ°ä¸€ä¸ªæ–°çš„ csv ä¸­` è¿™ä¸ªä»»åŠ¡ä¸ºä¾‹ï¼Œå‘æ‚¨å±•ç¤º Excel Agent åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„å‡ ä¸ªå…³é”®æ­¥éª¤åŠå…¶è¾“å‡ºï¼Œå¹¶é€šè¿‡å¯¹æ­¥éª¤çš„è§£é‡Šï¼Œç›´è§‚åœ°å‘ˆç° Agent çš„è¿è¡Œæµç¨‹åŠå…¶å¼ºå¤§èƒ½åŠ›ã€‚ï¼š

- Planner ç”Ÿæˆ JSON æ ¼å¼çš„åˆå§‹è®¡åˆ’

  ```yaml
  name: Planner
  answer: {
      **"steps"**: [
          {
              **"index"**: **1**,
              **"desc"**: **"Read the 'questions.csv' file into a pandas DataFrame."**
          },
          {
              **"index"**: **2**,
              **"desc"**: **"Extract the first column from the DataFrame."**
          },
          {
              **"index"**: **3**,
              **"desc"**: **"Save the extracted first column to a new CSV file."**
          }
      ]
  }
  ```
- Executor å°† CodeAgent ä½œä¸ºå·¥å…·è¿›è¡Œè°ƒç”¨ï¼Œæ‰§è¡Œè®¡åˆ’ä¸­çš„é¦–ä¸ªæ­¥éª¤

  ```yaml
  name: Executor
  tool name: CodeAgent
  arguments: {"request":"Read the 'questions.csv' file into a pandas DataFrame using pandas. Use the pandas.read_csv function and store the result in a variable named df."}
  ```
- CodeAgent ä½¿ç”¨ PythonRunner å·¥å…·è¿è¡Œä»£ç ï¼Œå¹¶ä½¿ç”¨ ReAct æ¨¡å¼è‡ªåŠ¨çº é”™ï¼Œä¿®æ­£ä»£ç ä¸­çš„é”™è¯¯

  ```yaml
  # CodeAgent ä½¿ç”¨ PythonRunner å·¥å…·è¿è¡Œä»£ç 
  name: Executor
  tool name: PythonRunner
  arguments: {"code":"```python\nfirst_column = df.iloc[:, 0]\n```"}

  # PythonRunner ä»£ç è¿è¡ŒæŠ¥é”™
  name: Executor
  tool response: Traceback (most recent call last):
    File "/User/user/go/src/github.com/cloudwego/eino-examples/adk/multiagent/integration-excel-agent/playground/00f118af-4bd8-42f7-8d11-71f2801218bd/00f118af-4bd8-42f7-8d11-71f2801218bd.py", line 1, in <module>
      first_column = df.iloc[:, 0]
                     ^^
  NameError: name 'df' is not defined

  # ReAct æ¨¡å¼è‡ªåŠ¨çº é”™ï¼Œä¿®æ­£æ— æ³•è¿è¡Œçš„ä»£ç 
  name: Executor
  answer: The error occurs because the DataFrame `df` is not defined. We need to first load the data from the existing CSV file `questions.csv` into `df`. Here's the corrected code:
  tool name: PythonRunner
  arguments: {"code":"```python\nimport pandas as pd\ndf = pd.read_csv('questions.csv')\nfirst_column = df.iloc[:, 0]\nprint(first_column.head())  # Verify the result\n```"}

  # ä»£ç è¿è¡ŒæˆåŠŸï¼Œè¿”å›è¿è¡Œç»“æœ
  name: Executor
  path: [{SequentialAgent} {plan_execute_replan} {Planner} {execute_replan} {Executor}]
  tool response: 
  0    multiple-choice
  1    multiple-choice
  2    multiple-choice
  3    multiple-choice
  4    multiple-choice
  Name: type, dtype: object
  ```
- Replanner åˆ¤æ–­è®¡åˆ’å®Œæˆï¼Œæäº¤è¿è¡Œç»“æœè‡³ ReportAgent

  ```yaml
  name: Replanner
  answer: {
      **"is_success"**: **true**,
      **"result"**: **"å·²æˆåŠŸå°†'questions.csv'è¡¨æ ¼ä¸­çš„ç¬¬ä¸€åˆ—æå–åˆ°æ–°çš„CSVæ–‡ä»¶'extracted_first_column.csv'ä¸­ã€‚"**,
      **"files"**: [
          {
              **"desc"**: **"åŒ…å«åŸè¡¨æ ¼ç¬¬ä¸€åˆ—æ•°æ®çš„æ–°CSVæ–‡ä»¶"**,
              **"path"**: **"extracted_first_column.csv"**
          }
      ]
  }
  ```
- ReportAgent è¿›è¡Œæ€»ç»“ï¼Œç»“æŸæ‰§è¡Œ

  ```yaml
  name: Report
  tool name: SubmitResult
  arguments: {
      **"is_success"**: **true**,
      **"result"**: **"Successfully extracted the first column from questions.csv and saved it to first_column.csv."**,
      **"files"**: [
          {
              **"path"**: **"/User/user/go/src/github.com/cloudwego/eino-examples/adk/multiagent/integration-excel-agent/playground/00f118af-4bd8-42f7-8d11-71f2801218bd/first_column.csv"**,
              **"desc"**: **"A CSV file containing only the first column data from the original questions.csv."**
          }
      ]
  }
  ```

## æ€»ç»“

Excel Agent  æ‰€å‘ˆç°çš„å¹¶éâ€œå•ä¸€æ™ºèƒ½ä½“â€çš„æŠ€å·§ï¼Œè€Œæ˜¯ä¸€å¥—ä»¥ Eino ADK ä¸ºåº•åº§çš„ Multi-Agent ç³»ç»Ÿå·¥ç¨‹åŒ–æ–¹æ³•è®ºï¼š

- ä»¥ ChatModelAgent çš„ ReAct èƒ½åŠ›ä¸ºåŸºçŸ³ï¼Œè®©æ¨¡å‹â€œå¯æ€è€ƒã€ä¼šè°ƒç”¨â€ã€‚
- ä»¥ WorkflowAgents çš„ç¼–æ’èƒ½åŠ›ï¼Œè®© Multi-Agent ç³»ç»Ÿä¸­çš„æ¯ä¸ª Agent ä»¥ç”¨æˆ·é¢„æœŸçš„é¡ºåºè¿è¡Œã€‚
- ä»¥ Plannerâ€“Executorâ€“Replanner çš„é—­ç¯ï¼Œè®©å¤æ‚ä»»åŠ¡â€œå¯æ‹†è§£ã€èƒ½çº é”™â€ã€‚
- ä»¥ History / Session çš„æ•°æ®ä¼ é€’æœºåˆ¶ï¼Œè®©å¤š Agent â€œèƒ½åä½œã€å¯å›æ”¾â€ã€‚

> ğŸ’¡
> **ç«‹å³å¼€å§‹ä½ çš„æ™ºèƒ½ä½“å¼€å‘ä¹‹æ—…**
>
> - âŒ¨ï¸ æŸ¥çœ‹ Excel Agent æºç ï¼š[Github Excel Agent æºç ](https://github.com/cloudwego/eino-examples/tree/main/adk/multiagent/integration-excel-agent)
> - ğŸ“š æŸ¥çœ‹æ›´å¤šæ–‡æ¡£ï¼š[Eino ADK æ–‡æ¡£](https://www.cloudwego.io/zh/docs/eino/core_modules/eino_adk/)
> - ğŸ› ï¸ æµè§ˆ ADK æºç ï¼š[Eino ADK æºç ](https://github.com/cloudwego/eino/tree/main/adk)
> - ğŸ’¡ æ¢ç´¢ ADK å…¨éƒ¨ç¤ºä¾‹ï¼š[Eino ADK Examples](https://github.com/cloudwego/eino-examples/tree/main/adk)
> - ğŸ¤ åŠ å…¥å¼€å‘è€…ç¤¾åŒºï¼šä¸å…¶ä»–å¼€å‘è€…äº¤æµç»éªŒå’Œæœ€ä½³å®è·µ
>
> Eino ADKï¼Œè®©æ™ºèƒ½ä½“å¼€å‘å˜å¾—ç®€å•è€Œå¼ºå¤§ï¼

<a href="/img/eino/Wt3Nbd2t4oMlUtxKw8hct36EnKb.png" target="_blank"><img src="/img/eino/Wt3Nbd2t4oMlUtxKw8hct36EnKb.png" width="100%" /></a>
