<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.142.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Eino: ChatModel guide | CloudWeGo</title>
<meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:url" content="https://www.cloudwego.io/docs/eino/core_modules/components/chat_model_guide/"><meta property="og:site_name" content="CloudWeGo"><meta property="og:title" content="Eino: ChatModel guide"><meta property="og:description" content="Basic Introduction The Model component is used to interact with large language models (LLM). Its primary function is to send user input messages to the language model and obtain the model’s response. This component plays an important role in the following scenarios:
Natural language dialogue Text generation and completion Parameter generation for tool invocation Multimodal interaction (text, image, audio, etc.) Component Definition Interface Definition Code Location: eino/components/model/interface.go
type ChatModel interface { Generate(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.Message, error) Stream(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.StreamReader[*schema.Message], error) BindTools(tools []*schema.ToolInfo) error } Generate Method Function: Generates a complete model response Parameters: ctx: Context object for passing request-level information and Callback Manager input: List of input messages opts: Optional parameters to configure model behavior Return values: *schema.Message: The response message generated by the model error: Error information during the generation process Stream Method Function: Generates model response in a streaming manner Parameters: Same as the Generate method Return values: *schema.StreamReader[*schema.Message]: Stream reader for model response error: Error information during the generation process BindTools Method Function: Binds available tools to the model Parameters: tools: List of tool information Return values: error: Error information during the binding process Message Structure Code Location: eino/schema/message.go"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-02-21T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-07T17:25:05+08:00"><meta itemprop=name content="Eino: ChatModel guide"><meta itemprop=description content="Basic Introduction The Model component is used to interact with large language models (LLM). Its primary function is to send user input messages to the language model and obtain the model’s response. This component plays an important role in the following scenarios:
Natural language dialogue Text generation and completion Parameter generation for tool invocation Multimodal interaction (text, image, audio, etc.) Component Definition Interface Definition Code Location: eino/components/model/interface.go
type ChatModel interface { Generate(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.Message, error) Stream(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.StreamReader[*schema.Message], error) BindTools(tools []*schema.ToolInfo) error } Generate Method Function: Generates a complete model response Parameters: ctx: Context object for passing request-level information and Callback Manager input: List of input messages opts: Optional parameters to configure model behavior Return values: *schema.Message: The response message generated by the model error: Error information during the generation process Stream Method Function: Generates model response in a streaming manner Parameters: Same as the Generate method Return values: *schema.StreamReader[*schema.Message]: Stream reader for model response error: Error information during the generation process BindTools Method Function: Binds available tools to the model Parameters: tools: List of tool information Return values: error: Error information during the binding process Message Structure Code Location: eino/schema/message.go"><meta itemprop=datePublished content="2025-02-21T00:00:00+00:00"><meta itemprop=dateModified content="2025-03-07T17:25:05+08:00"><meta itemprop=wordCount content="1392"><meta name=twitter:card content="summary"><meta name=twitter:title content="Eino: ChatModel guide"><meta name=twitter:description content="Basic Introduction The Model component is used to interact with large language models (LLM). Its primary function is to send user input messages to the language model and obtain the model’s response. This component plays an important role in the following scenarios:
Natural language dialogue Text generation and completion Parameter generation for tool invocation Multimodal interaction (text, image, audio, etc.) Component Definition Interface Definition Code Location: eino/components/model/interface.go
type ChatModel interface { Generate(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.Message, error) Stream(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.StreamReader[*schema.Message], error) BindTools(tools []*schema.ToolInfo) error } Generate Method Function: Generates a complete model response Parameters: ctx: Context object for passing request-level information and Callback Manager input: List of input messages opts: Optional parameters to configure model behavior Return values: *schema.Message: The response message generated by the model error: Error information during the generation process Stream Method Function: Generates model response in a streaming manner Parameters: Same as the Generate method Return values: *schema.StreamReader[*schema.Message]: Stream reader for model response error: Error information during the generation process BindTools Method Function: Binds available tools to the model Parameters: tools: List of tool information Return values: error: Error information during the binding process Message Structure Code Location: eino/schema/message.go"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYWRQRLPRM")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?f1808c42af827f368aa7eca3baae6d55",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preload href=/scss/main.min.b3c21c777309e05201dd625b8a4ece4076249bfa52b71d58c6e352d84c6c0320.css as=style><link href=/scss/main.min.b3c21c777309e05201dd625b8a4ece4076249bfa52b71d58c6e352d84c6c0320.css rel=stylesheet integrity><script src=/js/jquery.min.js></script><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=/css/docsearch.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYWRQRLPRM")}</script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span>
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu active"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/volo/>Volo</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a>
<a class=dropdown-item href=/docs/cwgo/>Cwgo</a>
<a class=dropdown-item href=/docs/eino/>Eino</a>
<a class=dropdown-item href=/docs/monolake/>Monolake</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cooperation/><span>Cooperation</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/eino/core_modules/components/chat_model_guide/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div id=docsearch></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div id=docsearch></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/eino/core_modules/components/chat_model_guide/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseino-li><input type=checkbox id=m-docseino-check checked>
<label for=m-docseino-check><a href=/docs/eino/ title="Eino: User Manual" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseino><span>Eino</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinooverview-li><input type=checkbox id=m-docseinooverview-check checked>
<label for=m-docseinooverview-check><a href=/docs/eino/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinooverview><span>Eino: Overview</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinooverviewbytedance_eino_practice-li><input type=checkbox id=m-docseinooverviewbytedance_eino_practice-check>
<label for=m-docseinooverviewbytedance_eino_practice-check><a href=/docs/eino/overview/bytedance_eino_practice/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinooverviewbytedance_eino_practice><span>Bytedance LLM Application Go Development Framework-Eino Practice</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoovervieweino_framework_structure-li><input type=checkbox id=m-docseinoovervieweino_framework_structure-check>
<label for=m-docseinoovervieweino_framework_structure-check><a href=/docs/eino/overview/eino_framework_structure/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoovervieweino_framework_structure><span>The structure of the Eino Framework</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoovervieweino_open_source-li><input type=checkbox id=m-docseinoovervieweino_open_source-check>
<label for=m-docseinoovervieweino_open_source-check><a href=/docs/eino/overview/eino_open_source/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoovervieweino_open_source><span>Large Language Model Application Development Framework — Eino is Now Open Source!</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoquick_start-li><input type=checkbox id=m-docseinoquick_start-check checked>
<label for=m-docseinoquick_start-check><a href=/docs/eino/quick_start/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoquick_start><span>Eino: Quick start</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoquick_startsimple_llm_application-li><input type=checkbox id=m-docseinoquick_startsimple_llm_application-check>
<label for=m-docseinoquick_startsimple_llm_application-check><a href=/docs/eino/quick_start/simple_llm_application/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoquick_startsimple_llm_application><span>Implement an easy LLM application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoquick_startagent_llm_with_tools-li><input type=checkbox id=m-docseinoquick_startagent_llm_with_tools-check>
<label for=m-docseinoquick_startagent_llm_with_tools-check><a href=/docs/eino/quick_start/agent_llm_with_tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoquick_startagent_llm_with_tools><span>Agent-Enable LLM to have hands</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseinocore_modules-li><input type=checkbox id=m-docseinocore_modules-check checked>
<label for=m-docseinocore_modules-check><a href=/docs/eino/core_modules/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modules><span>Eino: Core Modules</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulesflow_integration_components-li><input type=checkbox id=m-docseinocore_modulesflow_integration_components-check>
<label for=m-docseinocore_modulesflow_integration_components-check><a href=/docs/eino/core_modules/flow_integration_components/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulesflow_integration_components><span>Eino: Flow integration components</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-li><input type=checkbox id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-check>
<label for=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-check><a href=/docs/eino/core_modules/flow_integration_components/multi_agent_hosting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting><span>Eino Tutorial: Host Multi-Agent</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-li><input type=checkbox id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-check>
<label for=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-check><a href=/docs/eino/core_modules/flow_integration_components/react_agent_manual/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual><span>Eino: React Agent Manual</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_moduleschain_and_graph_orchestration-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestration-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestration-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_moduleschain_and_graph_orchestration><span>Eino: Chain & Graph Orchestration</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/callback_manual/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual><span>Eino: Callback Manual</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/chain_graph_introduction/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction><span>Eino: Chain/Graph Orchestration Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles><span>Eino: The design concept of orchestration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/stream_programming_essentials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials><span>Eino Points of Streaming Orchestration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/call_option_capabilities/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities><span>Eino: CallOption capabilities and specification</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseinocore_modulescomponents-li><input type=checkbox id=m-docseinocore_modulescomponents-check checked>
<label for=m-docseinocore_modulescomponents-check><a href=/docs/eino/core_modules/components/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulescomponents><span>Eino: Components</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docseinocore_modulescomponentschat_model_guide-li><input type=checkbox id=m-docseinocore_modulescomponentschat_model_guide-check checked>
<label for=m-docseinocore_modulescomponentschat_model_guide-check><a href=/docs/eino/core_modules/components/chat_model_guide/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentschat_model_guide><span class=td-sidebar-nav-active-item>Eino: ChatModel guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentschat_template_guide-li><input type=checkbox id=m-docseinocore_modulescomponentschat_template_guide-check>
<label for=m-docseinocore_modulescomponentschat_template_guide-check><a href=/docs/eino/core_modules/components/chat_template_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentschat_template_guide><span>Eino: ChatTemplate guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulescomponentsdocument_loader_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_loader_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_loader_guide-check><a href=/docs/eino/core_modules/components/document_loader_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulescomponentsdocument_loader_guide><span>Eino: Document Loader guide</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-check><a href=/docs/eino/core_modules/components/document_loader_guide/document_parser_interface_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide><span>Eino: Document Parser guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsdocument_transformer_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_transformer_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_transformer_guide-check><a href=/docs/eino/core_modules/components/document_transformer_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsdocument_transformer_guide><span>Eino: Document Transformer guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsembedding_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsembedding_guide-check>
<label for=m-docseinocore_modulescomponentsembedding_guide-check><a href=/docs/eino/core_modules/components/embedding_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsembedding_guide><span>Eino: Embedding guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsindexer_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsindexer_guide-check>
<label for=m-docseinocore_modulescomponentsindexer_guide-check><a href=/docs/eino/core_modules/components/indexer_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsindexer_guide><span>Eino: Indexer guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentslambda_guide-li><input type=checkbox id=m-docseinocore_modulescomponentslambda_guide-check>
<label for=m-docseinocore_modulescomponentslambda_guide-check><a href=/docs/eino/core_modules/components/lambda_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentslambda_guide><span>Eino: Lambda guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsretriever_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsretriever_guide-check>
<label for=m-docseinocore_modulescomponentsretriever_guide-check><a href=/docs/eino/core_modules/components/retriever_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsretriever_guide><span>Eino: Retriever guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentstools_node_guide-li><input type=checkbox id=m-docseinocore_modulescomponentstools_node_guide-check>
<label for=m-docseinocore_modulescomponentstools_node_guide-check><a href=/docs/eino/core_modules/components/tools_node_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentstools_node_guide><span>Eino: ToolsNode guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulesdevops-li><input type=checkbox id=m-docseinocore_modulesdevops-check>
<label for=m-docseinocore_modulesdevops-check><a href=/docs/eino/core_modules/devops/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulesdevops><span>EinoDev: Devops tools</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopside_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopside_plugin_guide-check>
<label for=m-docseinocore_modulesdevopside_plugin_guide-check><a href=/docs/eino/core_modules/devops/ide_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopside_plugin_guide><span>EinoDev IDE Plugin Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-check>
<label for=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-check><a href=/docs/eino/core_modules/devops/visual_orchestration_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide><span>EinoDev visual orchestration plugin guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-check>
<label for=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-check><a href=/docs/eino/core_modules/devops/visual_debug_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide><span>EinoDev visual debug plugin guide</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem-li><input type=checkbox id=m-docseinoecosystem-check checked>
<label for=m-docseinoecosystem-check><a href=/docs/eino/ecosystem/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem><span>Eino: Ecosystem</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemcallbacks-li><input type=checkbox id=m-docseinoecosystemcallbacks-check>
<label for=m-docseinoecosystemcallbacks-check><a href=/docs/eino/ecosystem/callbacks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemcallbacks><span>Callbacks</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemcallbackscallback_apmplus-li><input type=checkbox id=m-docseinoecosystemcallbackscallback_apmplus-check>
<label for=m-docseinoecosystemcallbackscallback_apmplus-check><a href=/docs/eino/ecosystem/callbacks/callback_apmplus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemcallbackscallback_apmplus><span>Callback - APMPlus</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemcallbackscallback_langfuse-li><input type=checkbox id=m-docseinoecosystemcallbackscallback_langfuse-check>
<label for=m-docseinoecosystemcallbackscallback_langfuse-check><a href=/docs/eino/ecosystem/callbacks/callback_langfuse/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemcallbackscallback_langfuse><span>Callback - Langfuse</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemchat_model-li><input type=checkbox id=m-docseinoecosystemchat_model-check>
<label for=m-docseinoecosystemchat_model-check><a href=/docs/eino/ecosystem/chat_model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemchat_model><span>ChatModel</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemchat_modelchat_model_ark-li><input type=checkbox id=m-docseinoecosystemchat_modelchat_model_ark-check>
<label for=m-docseinoecosystemchat_modelchat_model_ark-check><a href=/docs/eino/ecosystem/chat_model/chat_model_ark/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemchat_modelchat_model_ark><span>ChatModel - ARK</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemchat_modelchat_model_ollama-li><input type=checkbox id=m-docseinoecosystemchat_modelchat_model_ollama-check>
<label for=m-docseinoecosystemchat_modelchat_model_ollama-check><a href=/docs/eino/ecosystem/chat_model/chat_model_ollama/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemchat_modelchat_model_ollama><span>ChatModel - Ollama</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemchat_modelchat_model_openai-li><input type=checkbox id=m-docseinoecosystemchat_modelchat_model_openai-check>
<label for=m-docseinoecosystemchat_modelchat_model_openai-check><a href=/docs/eino/ecosystem/chat_model/chat_model_openai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemchat_modelchat_model_openai><span>ChatModel - OpenAI</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemdocument-li><input type=checkbox id=m-docseinoecosystemdocument-check>
<label for=m-docseinoecosystemdocument-check><a href=/docs/eino/ecosystem/document/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemdocument><span>Document</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentsplitter_markdown-li><input type=checkbox id=m-docseinoecosystemdocumentsplitter_markdown-check>
<label for=m-docseinoecosystemdocumentsplitter_markdown-check><a href=/docs/eino/ecosystem/document/splitter_markdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentsplitter_markdown><span>Splitter - markdown</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentloader_amazon_s3-li><input type=checkbox id=m-docseinoecosystemdocumentloader_amazon_s3-check>
<label for=m-docseinoecosystemdocumentloader_amazon_s3-check><a href=/docs/eino/ecosystem/document/loader_amazon_s3/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentloader_amazon_s3><span>Loader - amazon s3</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentloader_local_file-li><input type=checkbox id=m-docseinoecosystemdocumentloader_local_file-check>
<label for=m-docseinoecosystemdocumentloader_local_file-check><a href=/docs/eino/ecosystem/document/loader_local_file/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentloader_local_file><span>Loader - local file</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentloader_web_url-li><input type=checkbox id=m-docseinoecosystemdocumentloader_web_url-check>
<label for=m-docseinoecosystemdocumentloader_web_url-check><a href=/docs/eino/ecosystem/document/loader_web_url/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentloader_web_url><span>Loader - web url</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentparser_html-li><input type=checkbox id=m-docseinoecosystemdocumentparser_html-check>
<label for=m-docseinoecosystemdocumentparser_html-check><a href=/docs/eino/ecosystem/document/parser_html/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentparser_html><span>Parser - html</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentparser_pdf-li><input type=checkbox id=m-docseinoecosystemdocumentparser_pdf-check>
<label for=m-docseinoecosystemdocumentparser_pdf-check><a href=/docs/eino/ecosystem/document/parser_pdf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentparser_pdf><span>Parser - pdf</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentsplitter_recursive-li><input type=checkbox id=m-docseinoecosystemdocumentsplitter_recursive-check>
<label for=m-docseinoecosystemdocumentsplitter_recursive-check><a href=/docs/eino/ecosystem/document/splitter_recursive/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentsplitter_recursive><span>Splitter - recursive</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemdocumentsplitter_semantic-li><input type=checkbox id=m-docseinoecosystemdocumentsplitter_semantic-check>
<label for=m-docseinoecosystemdocumentsplitter_semantic-check><a href=/docs/eino/ecosystem/document/splitter_semantic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemdocumentsplitter_semantic><span>Splitter - semantic</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemembedding-li><input type=checkbox id=m-docseinoecosystemembedding-check>
<label for=m-docseinoecosystemembedding-check><a href=/docs/eino/ecosystem/embedding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemembedding><span>Embedding</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemembeddingembedding_openai-li><input type=checkbox id=m-docseinoecosystemembeddingembedding_openai-check>
<label for=m-docseinoecosystemembeddingembedding_openai-check><a href=/docs/eino/ecosystem/embedding/embedding_openai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemembeddingembedding_openai><span>Embedding - OpenAI</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemembeddingembedding_ark-li><input type=checkbox id=m-docseinoecosystemembeddingembedding_ark-check>
<label for=m-docseinoecosystemembeddingembedding_ark-check><a href=/docs/eino/ecosystem/embedding/embedding_ark/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemembeddingembedding_ark><span>Embedding - ARK</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemindexer-li><input type=checkbox id=m-docseinoecosystemindexer-check>
<label for=m-docseinoecosystemindexer-check><a href=/docs/eino/ecosystem/indexer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemindexer><span>Indexer</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemindexerindexer_volc_vikingdb-li><input type=checkbox id=m-docseinoecosystemindexerindexer_volc_vikingdb-check>
<label for=m-docseinoecosystemindexerindexer_volc_vikingdb-check><a href=/docs/eino/ecosystem/indexer/indexer_volc_vikingdb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemindexerindexer_volc_vikingdb><span>Indexer - volc VikingDB</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemretriever-li><input type=checkbox id=m-docseinoecosystemretriever-check>
<label for=m-docseinoecosystemretriever-check><a href=/docs/eino/ecosystem/retriever/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemretriever><span>Retriever</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemretrieverretriever_volc_vikingdb-li><input type=checkbox id=m-docseinoecosystemretrieverretriever_volc_vikingdb-check>
<label for=m-docseinoecosystemretrieverretriever_volc_vikingdb-check><a href=/docs/eino/ecosystem/retriever/retriever_volc_vikingdb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemretrieverretriever_volc_vikingdb><span>Retriever - volc VikingDB</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystemtool-li><input type=checkbox id=m-docseinoecosystemtool-check>
<label for=m-docseinoecosystemtool-check><a href=/docs/eino/ecosystem/tool/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystemtool><span>Tool</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemtooltool_duckduckgo_search-li><input type=checkbox id=m-docseinoecosystemtooltool_duckduckgo_search-check>
<label for=m-docseinoecosystemtooltool_duckduckgo_search-check><a href=/docs/eino/ecosystem/tool/tool_duckduckgo_search/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemtooltool_duckduckgo_search><span>Tool - DuckDuckGoSearch</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystemtooltool_googlesearch-li><input type=checkbox id=m-docseinoecosystemtooltool_googlesearch-check>
<label for=m-docseinoecosystemtooltool_googlesearch-check><a href=/docs/eino/ecosystem/tool/tool_googlesearch/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystemtooltool_googlesearch><span>Tool - Googlesearch</span></a></label></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en//docs/eino/core_modules/components/chat_model_guide target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en//docs/eino/core_modules/components/chat_model_guide?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?labels=bug&amp;template=DOCS_UPDATE.md&amp;title=Eino:%20ChatModel%20guide" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/eino/issues/new/choose target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#basic-introduction><strong>Basic Introduction</strong></a></li><li><a href=#component-definition><strong>Component Definition</strong></a><ul><li><a href=#interface-definition><strong>Interface Definition</strong></a></li><li><a href=#message-structure><strong>Message Structure</strong></a></li><li><a href=#common-options><strong>Common Options</strong></a></li></ul></li><li><a href=#how-to-use><strong>How to Use</strong></a><ul><li><a href=#use-alone><strong>Use Alone</strong></a></li><li><a href=#use-in-orchestration><strong>Use in Orchestration</strong></a></li></ul></li><li><a href=#using-option-and-callback><strong>Using Option and Callback</strong></a><ul><li><a href=#option-usage-example><strong>Option Usage Example</strong></a></li><li><a href=#callback-usage-example><strong>Callback Usage Example</strong></a></li></ul></li><li><a href=#existing-implementations><strong>Existing Implementations</strong></a></li><li><a href=#self-implementation-reference><strong>Self-Implementation Reference</strong></a><ul><li><a href=#option-mechanism><strong>Option Mechanism</strong></a></li><li><a href=#callback-handling><strong>Callback Handling</strong></a></li><li><a href=#complete-implementation-example><strong>Complete Implementation Example</strong></a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/>Eino</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/core_modules/>Eino: Core Modules</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/core_modules/components/>Eino: Components</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://www.cloudwego.io/docs/eino/core_modules/components/chat_model_guide/>Eino: ChatModel guide</a></li></ol></nav><div class=td-content><h1>Eino: ChatModel guide</h1><header class=article-meta></header><h2 id=basic-introduction><strong>Basic Introduction</strong></h2><p>The Model component is used to interact with large language models (LLM). Its primary function is to send user input messages to the language model and obtain the model&rsquo;s response. This component plays an important role in the following scenarios:</p><ul><li>Natural language dialogue</li><li>Text generation and completion</li><li>Parameter generation for tool invocation</li><li>Multimodal interaction (text, image, audio, etc.)</li></ul><h2 id=component-definition><strong>Component Definition</strong></h2><h3 id=interface-definition><strong>Interface Definition</strong></h3><blockquote><p>Code Location: eino/components/model/interface.go</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>ChatModel</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Generate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Stream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>BindTools</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>tools</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ToolInfo</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>error</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=generate-method><strong>Generate Method</strong></h4><ul><li>Function: Generates a complete model response</li><li>Parameters:<ul><li>ctx: Context object for passing request-level information and Callback Manager</li><li>input: List of input messages</li><li>opts: Optional parameters to configure model behavior</li></ul></li><li>Return values:<ul><li><code>*schema.Message</code>: The response message generated by the model</li><li>error: Error information during the generation process</li></ul></li></ul><h4 id=stream-method><strong>Stream Method</strong></h4><ul><li>Function: Generates model response in a streaming manner</li><li>Parameters: Same as the Generate method</li><li>Return values:<ul><li><code>*schema.StreamReader[*schema.Message]</code>: Stream reader for model response</li><li>error: Error information during the generation process</li></ul></li></ul><h4 id=bindtools-method><strong>BindTools Method</strong></h4><ul><li>Function: Binds available tools to the model</li><li>Parameters:<ul><li>tools: List of tool information</li></ul></li><li>Return values:<ul><li>error: Error information during the binding process</li></ul></li></ul><h3 id=message-structure><strong>Message Structure</strong></h3><blockquote><p>Code Location: eino/schema/message.go</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Message</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Role indicates the role of the message (system/user/assistant/tool)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Role</span> <span style=color:#000>RoleType</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Content is the text content of the message</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Content</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// MultiContent is multimodal content supporting text, image, audio, etc.</span>
</span></span><span style=display:flex><span>    <span style=color:#000>MultiContent</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>ChatMessagePart</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Name is the name of the message sender</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Name</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ToolCalls is the tool invocation information in assistant messages</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ToolCalls</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>ToolCall</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ToolCallID is the tool invocation ID in tool messages</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ToolCallID</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ResponseMeta contains meta-information about the response</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ResponseMeta</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>ResponseMeta</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Extra is used to store additional information</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Extra</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>any</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The <code>Message</code> structure is the basic structure for model interaction, supporting:</p><ul><li>Multiple roles: system, user, assistant (AI), tool</li><li>Multimodal content: text, image, audio, video, file</li><li>Tool invocation: supports model calling external tools and functions</li><li>Meta-information: includes reasons for the response, token usage statistics, etc.</li></ul><h3 id=common-options><strong>Common Options</strong></h3><p>The Model component provides a set of common options to configure model behavior:</p><blockquote><p>Code Location: eino/components/model/option.go</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Options</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Temperature controls the randomness of the output</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Temperature</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>float32</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// MaxTokens controls the maximum number of tokens generated</span>
</span></span><span style=display:flex><span>    <span style=color:#000>MaxTokens</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Model specifies the name of the model used</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Model</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// TopP controls the diversity of the output</span>
</span></span><span style=display:flex><span>    <span style=color:#000>TopP</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>float32</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Stop specifies the conditions to stop generation</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Stop</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Options can be set in the following way:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Set temperature</span>
</span></span><span style=display:flex><span><span style=color:#000>WithTemperature</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>temperature</span> <span style=color:#204a87;font-weight:700>float32</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Set maximum token count</span>
</span></span><span style=display:flex><span><span style=color:#000>WithMaxTokens</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>maxTokens</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Set model name</span>
</span></span><span style=display:flex><span><span style=color:#000>WithModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Set top_p value</span>
</span></span><span style=display:flex><span><span style=color:#000>WithTopP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>topP</span> <span style=color:#204a87;font-weight:700>float32</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Set stop words</span>
</span></span><span style=display:flex><span><span style=color:#000>WithStop</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stop</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</span></span></code></pre></div><h2 id=how-to-use><strong>How to Use</strong></h2><h3 id=use-alone><strong>Use Alone</strong></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;io&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino-ext/components/model/openai&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/components/model&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Initialize the model (using OpenAI as an example)</span>
</span></span><span style=display:flex><span><span style=color:#000>cm</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>openai</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>openai</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ChatModelConfig</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Configuration parameters</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Prepare input messages</span>
</span></span><span style=display:flex><span><span style=color:#000>messages</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Role</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>System</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Content</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;You are a helpful assistant.&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Role</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>User</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Content</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Hello!&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Generate response</span>
</span></span><span style=display:flex><span><span style=color:#000>response</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Generate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTemperature</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0.8</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Handle response</span>
</span></span><span style=display:flex><span><span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Stream generation</span>
</span></span><span style=display:flex><span><span style=color:#000>streamResult</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Stream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>streamResult</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>chunk</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>streamResult</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Recv</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>io</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EOF</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>break</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#8f5902;font-style:italic>// Error handling</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Handle response chunk</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>chunk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=use-in-orchestration><strong>Use in Orchestration</strong></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/compose&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*** Initialize ChatModel
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>* cm, err := xxx
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use in Chain</span>
</span></span><span style=display:flex><span><span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewChain</span><span style=color:#000;font-weight:700>[[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>]()</span>
</span></span><span style=display:flex><span><span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AppendChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cm</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use in Graph</span>
</span></span><span style=display:flex><span><span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewGraph</span><span style=color:#000;font-weight:700>[[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>]()</span>
</span></span><span style=display:flex><span><span style=color:#000>g</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;model_node&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>cm</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=using-option-and-callback><strong>Using Option and Callback</strong></h2><h3 id=option-usage-example><strong>Option Usage Example</strong></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/components/model&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use Option</span>
</span></span><span style=display:flex><span><span style=color:#000>response</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Generate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTemperature</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0.7</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMaxTokens</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2000</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;gpt-4&#34;</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=callback-usage-example><strong>Callback Usage Example</strong></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/callbacks&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/components/model&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/compose&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>callbacksHelper</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/utils/callbacks&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Create callback handler</span>
</span></span><span style=display:flex><span><span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>callbacksHelper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ModelCallbackHandler</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>OnStart</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>info</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunInfo</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackInput</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Generation started, number of input messages: %d\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>input</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Messages</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ctx</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000>OnEnd</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>info</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunInfo</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>output</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Generation completed, Token usage: %+v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>output</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TokenUsage</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ctx</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000>OnEndWithStreamOutput</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>info</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunInfo</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>output</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>])</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Println</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Receiving streaming output&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>output</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ctx</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use callback handler</span>
</span></span><span style=display:flex><span><span style=color:#000>helper</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>callbacksHelper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewHandlerHelper</span><span style=color:#000;font-weight:700>().</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#000;font-weight:700>).</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Handler</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*** compose a chain
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>* chain := NewChain
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>* chain.appendxxx().
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>*       appendxxx().
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>*       ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use at runtime</span>
</span></span><span style=display:flex><span><span style=color:#000>runnable</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>chain</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Compile</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>runnable</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Invoke</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithCallbacks</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>helper</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h2 id=existing-implementations><strong>Existing Implementations</strong></h2><ol><li>OpenAI ChatModel: Use OpenAI&rsquo;s GPT series models <a href=/en/docs/eino/ecosystem/chat_model/chat_model_openai>ChatModel - OpenAI</a></li><li>Ollama ChatModel: Use Ollama local models <a href=/en/docs/eino/ecosystem/chat_model/chat_model_ollama>ChatModel - Ollama</a></li><li>ARK ChatModel: Use ARK platform&rsquo;s model service <a href=/en/docs/eino/ecosystem/chat_model/chat_model_ark>ChatModel - ARK</a></li></ol><h2 id=self-implementation-reference><strong>Self-Implementation Reference</strong></h2><p>When implementing a custom ChatModel component, you need to pay attention to the following points:</p><ol><li>Make sure to implement common options</li><li>Ensure the callback mechanism is implemented</li><li>Remember to close the writer after completing the output during streaming</li></ol><h3 id=option-mechanism><strong>Option Mechanism</strong></h3><p>When customizing ChatModel, if you need options other than the common ones, you can use the component abstraction utility functions to implement custom options, for example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;time&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/components/model&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Define the Option struct</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>MyChatModelOptions</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Options</span>    <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span>
</span></span><span style=display:flex><span>    <span style=color:#000>RetryCount</span> <span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Timeout</span>    <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Define Option functions</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRetryCount</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>count</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WrapImplSpecificOptFn</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>o</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>o</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RetryCount</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>count</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>timeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WrapImplSpecificOptFn</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>o</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>o</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Timeout</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>timeout</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=callback-handling><strong>Callback Handling</strong></h3><p>ChatModel implementation needs to trigger callbacks at appropriate times. The following structures are defined by the ChatModel component:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Define callback input and output</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>CallbackInput</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Messages</span>    <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Model</span>       <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Temperature</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>float32</span>
</span></span><span style=display:flex><span>    <span style=color:#000>MaxTokens</span>   <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Extra</span>       <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>any</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>CallbackOutput</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Message</span>    <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span>
</span></span><span style=display:flex><span>    <span style=color:#000>TokenUsage</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TokenUsage</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Extra</span>      <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>any</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=complete-implementation-example><strong>Complete Implementation Example</strong></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;errors&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;time&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/callbacks&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/components/model&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>MyChatModel</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span>     <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span>
</span></span><span style=display:flex><span>    <span style=color:#000>apiKey</span>     <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#000>baseURL</span>    <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span>      <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#000>timeout</span>    <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span>    <span style=color:#000>retryCount</span> <span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>MyChatModelConfig</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>APIKey</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewMyChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModelConfig</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>APIKey</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>errors</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>New</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;api key is required&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>client</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>{},</span>
</span></span><span style=display:flex><span>       <span style=color:#000>apiKey</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>APIKey</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Generate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 1. Handle options</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Options</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>Model</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>       <span style=color:#000>RetryCount</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>retryCount</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Timeout</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>timeout</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetCommonOptions</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetImplSpecificOptions</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 2. Callback before starting generation</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ctx</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OnStart</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackInput</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Messages</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Config</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>Model</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Model</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 3. Execute generation logic</span>
</span></span><span style=display:flex><span>    <span style=color:#000>response</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>doGenerate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>options</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 4. Handle errors and end callback</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>ctx</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OnError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>ctx</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OnEnd</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Message</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>response</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>response</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Stream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 1. Handle options</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Options</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>Model</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>       <span style=color:#000>RetryCount</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>retryCount</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Timeout</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>timeout</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetCommonOptions</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>options</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetImplSpecificOptions</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 2. Callback before starting streaming generation</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ctx</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OnStart</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackInput</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Messages</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000>Config</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>Model</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Model</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 3. Create Streaming Response</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Pipe creates a StreamReader and a StreamWriter, writing to the StreamWriter can be read from the StreamReader, and both are thread-safe.</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Implement asynchronous writing to the StreamWriter with the generated content, returning the StreamReader as the result</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ***StreamReader is a data stream that can only be read once. When implementing the callback by yourself, it is necessary to pass the data stream to the callback through OnEndWithCallbackOutput and also return the data stream, requiring a copy of the data stream</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Considering that such scenarios always require copying the data stream, the OnEndWithCallbackOutput function will internally copy and return an unread stream</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// The following code demonstrates a streaming processing method, but it is not the only way</span>
</span></span><span style=display:flex><span>    <span style=color:#000>sr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sw</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Pipe</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>](</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 4. Start Asynchronous Generation</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>go</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>sw</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#8f5902;font-style:italic>// Stream writing</span>
</span></span><span style=display:flex><span>       <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>doStream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sw</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 5. Complete Callback</span>
</span></span><span style=display:flex><span>    <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>nsr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>callbacks</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OnEndWithStreamOutput</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sr</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReaderWithConvert</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nsr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>t</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}),</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>BindTools</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>tools</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ToolInfo</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>error</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Implement tool binding logic</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>doGenerate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Implement generation logic</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModel</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>doStream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>messages</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>MyChatModelOptions</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sr</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamWriter</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CallbackOutput</span><span style=color:#000;font-weight:700>])</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Stream generate text written into sr</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
March 7, 2025
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/590388601ba4c26232b5ba3dcdef1bb571867ba4>doc: update plugin install guide (#1272) (5903886)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Lark aria-label=Lark><a class=text-white target=_blank rel=noopener href="https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=693v2544-2664-4421-b50f-7f1912p745r6" aria-label=Lark><img src=/webfonts/lark.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/CloudWeGo aria-label=Twitter><img src=/webfonts/x-twitter.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cloudwego aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/jceZSE7DsW aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/main.min.9a8648b987db06195f5768f0d7516e8df7c27669e91e383e25c5d07cd6325605.js integrity="sha256-moZIuYfbBhlfV2jw11FujffCdmnpHjg+JcXQfNYyVgU=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/prism-custom.js></script><script src=/js/tabpane-persist.js></script><script src=/js/docsearch.js></script><script type=text/javascript>let siteLang=window.location.pathname.startsWith("/zh/")?"zh":"en";docsearch({appId:"V7I042F992",apiKey:"8380a7ac88106841cb43fb000fa2edb4",indexName:"cloudwego",container:"#docsearch",searchParameters:{hitsPerPage:5,facetFilters:[`lang:${siteLang}`]},transformItems(e){return e.map(e=>({...e,url:e.url.replace("www.cloudwego.io",location.host).replace("https:",location.protocol)}))}})</script><script src=/js/outbound-link.js></script><script src=/js/navScroll.js></script></body></html>