<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.142.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Basic Usage | CloudWeGo</title>
<meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:url" content="https://www.cloudwego.io/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/"><meta property="og:site_name" content="CloudWeGo"><meta property="og:title" content="Basic Usage"><meta property="og:description" content="Complete guide to Kitex generic calls including binary forwarding, HTTP mapping, Map/JSON mapping, and Protobuf binary generic calls."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-09-28T00:00:00+00:00"><meta property="article:modified_time" content="2025-09-29T11:50:47+08:00"><meta itemprop=name content="Basic Usage"><meta itemprop=description content="Complete guide to Kitex generic calls including binary forwarding, HTTP mapping, Map/JSON mapping, and Protobuf binary generic calls."><meta itemprop=datePublished content="2025-09-28T00:00:00+00:00"><meta itemprop=dateModified content="2025-09-29T11:50:47+08:00"><meta itemprop=wordCount content="5781"><meta itemprop=keywords content="generic-call,HTTP,Thrift,Protobuf,Map,JSON"><meta name=twitter:card content="summary"><meta name=twitter:title content="Basic Usage"><meta name=twitter:description content="Complete guide to Kitex generic calls including binary forwarding, HTTP mapping, Map/JSON mapping, and Protobuf binary generic calls."><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYWRQRLPRM")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?f1808c42af827f368aa7eca3baae6d55",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preload href=/scss/main.min.8dda0a7e68c787c1e8d950ad927bf6783703a0048d569c37d9e7d2726622eaff.css as=style><link href=/scss/main.min.8dda0a7e68c787c1e8d950ad927bf6783703a0048d569c37d9e7d2726622eaff.css rel=stylesheet integrity><script src=/js/jquery.min.js></script><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=/css/docsearch.css></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span>
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu active"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/volo/>Volo</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a>
<a class=dropdown-item href=/docs/eino/>Eino</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cooperation/><span>Cooperation</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div id=docsearch></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div id=docsearch></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docskitex-li><input type=checkbox id=m-docskitex-check checked>
<label for=m-docskitex-check><a href=/docs/kitex/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitex><span>Kitex</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexoverview-li><input type=checkbox id=m-docskitexoverview-check checked>
<label for=m-docskitexoverview-check><a href=/docs/kitex/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitexgetting-started-li><input type=checkbox id=m-docskitexgetting-started-check checked>
<label for=m-docskitexgetting-started-check><a href=/docs/kitex/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexgetting-started><span>Getting Started</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexgetting-startedpre-knowledge-li><input type=checkbox id=m-docskitexgetting-startedpre-knowledge-check>
<label for=m-docskitexgetting-startedpre-knowledge-check><a href=/docs/kitex/getting-started/pre-knowledge/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexgetting-startedpre-knowledge><span>Pre-knowledge</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexgetting-startedprerequisite-li><input type=checkbox id=m-docskitexgetting-startedprerequisite-check>
<label for=m-docskitexgetting-startedprerequisite-check><a href=/docs/kitex/getting-started/prerequisite/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexgetting-startedprerequisite><span>Environment Preparation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexgetting-startedquick_start-li><input type=checkbox id=m-docskitexgetting-startedquick_start-check>
<label for=m-docskitexgetting-startedquick_start-check><a href=/docs/kitex/getting-started/quick_start/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexgetting-startedquick_start><span>Basic Example</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexgetting-startedtutorial-li><input type=checkbox id=m-docskitexgetting-startedtutorial-check>
<label for=m-docskitexgetting-startedtutorial-check><a href=/docs/kitex/getting-started/tutorial/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexgetting-startedtutorial><span>Advanced Tutorial</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexgetting-startedexamples-li><input type=checkbox id=m-docskitexgetting-startedexamples-check>
<label for=m-docskitexgetting-startedexamples-check><a href=/docs/kitex/getting-started/examples/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexgetting-startedexamples><span>Code Examples</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docskitextutorials-li><input type=checkbox id=m-docskitextutorials-check checked>
<label for=m-docskitextutorials-check><a href=/docs/kitex/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorials><span>Tutorials</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-feature-li><input type=checkbox id=m-docskitextutorialsbasic-feature-check>
<label for=m-docskitextutorialsbasic-feature-check><a href=/docs/kitex/tutorials/basic-feature/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-feature><span>Basic Feature</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featuremessage_type-li><input type=checkbox id=m-docskitextutorialsbasic-featuremessage_type-check>
<label for=m-docskitextutorialsbasic-featuremessage_type-check><a href=/docs/kitex/tutorials/basic-feature/message_type/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featuremessage_type><span>Message Types</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-featurestreamx-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamx-check>
<label for=m-docskitextutorialsbasic-featurestreamx-check><a href=/docs/kitex/tutorials/basic-feature/streamx/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-featurestreamx><span>StreamX</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_basic_programming-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_basic_programming-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_basic_programming-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_basic_programming/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_basic_programming><span>StreamX Basic Programming</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_middleware-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_middleware-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_middleware-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_middleware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_middleware><span>StreamX Middleware</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_metainfo-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_metainfo-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_metainfo-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_metainfo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_metainfo><span>StreamX Metainfo</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_error_handling-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_error_handling-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_error_handling-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_error_handling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_error_handling><span>StreamX Error Handling</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_faq-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_faq-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_faq-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_faq><span>StreamX FAQ</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurestreamxstreamx_timeout_control-li><input type=checkbox id=m-docskitextutorialsbasic-featurestreamxstreamx_timeout_control-check>
<label for=m-docskitextutorialsbasic-featurestreamxstreamx_timeout_control-check><a href=/docs/kitex/tutorials/basic-feature/streamx/streamx_timeout_control/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurestreamxstreamx_timeout_control><span>StreamX Timeout Control</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-featureprotocol-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocol-check>
<label for=m-docskitextutorialsbasic-featureprotocol-check><a href=/docs/kitex/tutorials/basic-feature/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-featureprotocol><span>Protocol</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocoltransport_protocol-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocoltransport_protocol-check>
<label for=m-docskitextutorialsbasic-featureprotocoltransport_protocol-check><a href=/docs/kitex/tutorials/basic-feature/protocol/transport_protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocoltransport_protocol><span>Transport Protocol</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-featureprotocolstreaming-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolstreaming-check>
<label for=m-docskitextutorialsbasic-featureprotocolstreaming-check><a href=/docs/kitex/tutorials/basic-feature/protocol/streaming/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-featureprotocolstreaming><span>Streaming</span></a></label><ul class="ul-6 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpc-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolstreaminggrpc-check>
<label for=m-docskitextutorialsbasic-featureprotocolstreaminggrpc-check><a href=/docs/kitex/tutorials/basic-feature/protocol/streaming/grpc/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpc><span>gRPC</span></a></label><ul class="ul-7 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcthrift_streaming-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcthrift_streaming-check>
<label for=m-docskitextutorialsbasic-featureprotocolstreaminggrpcthrift_streaming-check><a href=/docs/kitex/tutorials/basic-feature/protocol/streaming/grpc/thrift_streaming/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcthrift_streaming><span>Thrift Streaming over gRPC</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcgraceful_shutdown-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcgraceful_shutdown-check>
<label for=m-docskitextutorialsbasic-featureprotocolstreaminggrpcgraceful_shutdown-check><a href=/docs/kitex/tutorials/basic-feature/protocol/streaming/grpc/graceful_shutdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocolstreaminggrpcgraceful_shutdown><span>gRPC Streaming Graceful Shutdown</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsbasic-featureprotocolserialization-protocol-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolserialization-protocol-check>
<label for=m-docskitextutorialsbasic-featureprotocolserialization-protocol-check><a href=/docs/kitex/tutorials/basic-feature/protocol/serialization-protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsbasic-featureprotocolserialization-protocol><span>Serialization Protocol</span></a></label><ul class="ul-6 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolbinary-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolserialization-protocolbinary-check>
<label for=m-docskitextutorialsbasic-featureprotocolserialization-protocolbinary-check><a href=/docs/kitex/tutorials/basic-feature/protocol/serialization-protocol/binary/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolbinary><span>Binary</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolprotobuf-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolserialization-protocolprotobuf-check>
<label for=m-docskitextutorialsbasic-featureprotocolserialization-protocolprotobuf-check><a href=/docs/kitex/tutorials/basic-feature/protocol/serialization-protocol/protobuf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolprotobuf><span>Protobuf</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolhessian2-li><input type=checkbox id=m-docskitextutorialsbasic-featureprotocolserialization-protocolhessian2-check>
<label for=m-docskitextutorialsbasic-featureprotocolserialization-protocolhessian2-check><a href=/docs/kitex/tutorials/basic-feature/protocol/serialization-protocol/hessian2/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureprotocolserialization-protocolhessian2><span>Hessian2</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurevisit_directly-li><input type=checkbox id=m-docskitextutorialsbasic-featurevisit_directly-check>
<label for=m-docskitextutorialsbasic-featurevisit_directly-check><a href=/docs/kitex/tutorials/basic-feature/visit_directly/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurevisit_directly><span>Visit Directly</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureconnection_type-li><input type=checkbox id=m-docskitextutorialsbasic-featureconnection_type-check>
<label for=m-docskitextutorialsbasic-featureconnection_type-check><a href=/docs/kitex/tutorials/basic-feature/connection_type/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureconnection_type><span>Connection Type</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurebizstatuserr-li><input type=checkbox id=m-docskitextutorialsbasic-featurebizstatuserr-check>
<label for=m-docskitextutorialsbasic-featurebizstatuserr-check><a href=/docs/kitex/tutorials/basic-feature/bizstatuserr/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurebizstatuserr><span>Business Exception</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurewarming_up-li><input type=checkbox id=m-docskitextutorialsbasic-featurewarming_up-check>
<label for=m-docskitextutorialsbasic-featurewarming_up-check><a href=/docs/kitex/tutorials/basic-feature/warming_up/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurewarming_up><span>Warming Up</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featurepanic-li><input type=checkbox id=m-docskitextutorialsbasic-featurepanic-check>
<label for=m-docskitextutorialsbasic-featurepanic-check><a href=/docs/kitex/tutorials/basic-feature/panic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featurepanic><span>Deal with panic</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsbasic-featureacquire_rpcinfo-li><input type=checkbox id=m-docskitextutorialsbasic-featureacquire_rpcinfo-check>
<label for=m-docskitextutorialsbasic-featureacquire_rpcinfo-check><a href=/docs/kitex/tutorials/basic-feature/acquire_rpcinfo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsbasic-featureacquire_rpcinfo><span>Acquire Kitex RPC Info</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsservice-governance-li><input type=checkbox id=m-docskitextutorialsservice-governance-check>
<label for=m-docskitextutorialsservice-governance-check><a href=/docs/kitex/tutorials/service-governance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsservice-governance><span>Service Governance</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governanceloadbalance-li><input type=checkbox id=m-docskitextutorialsservice-governanceloadbalance-check>
<label for=m-docskitextutorialsservice-governanceloadbalance-check><a href=/docs/kitex/tutorials/service-governance/loadbalance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governanceloadbalance><span>LoadBalancer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governancetimeout-li><input type=checkbox id=m-docskitextutorialsservice-governancetimeout-check>
<label for=m-docskitextutorialsservice-governancetimeout-check><a href=/docs/kitex/tutorials/service-governance/timeout/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governancetimeout><span>Timeouts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governanceretry-li><input type=checkbox id=m-docskitextutorialsservice-governanceretry-check>
<label for=m-docskitextutorialsservice-governanceretry-check><a href=/docs/kitex/tutorials/service-governance/retry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governanceretry><span>Retry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governancecircuitbreaker-li><input type=checkbox id=m-docskitextutorialsservice-governancecircuitbreaker-check>
<label for=m-docskitextutorialsservice-governancecircuitbreaker-check><a href=/docs/kitex/tutorials/service-governance/circuitbreaker/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governancecircuitbreaker><span>Circuit Breaker</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governancefallback-li><input type=checkbox id=m-docskitextutorialsservice-governancefallback-check>
<label for=m-docskitextutorialsservice-governancefallback-check><a href=/docs/kitex/tutorials/service-governance/fallback/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governancefallback><span>Fallback</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governancelimiting-li><input type=checkbox id=m-docskitextutorialsservice-governancelimiting-check>
<label for=m-docskitextutorialsservice-governancelimiting-check><a href=/docs/kitex/tutorials/service-governance/limiting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governancelimiting><span>Rate Limiting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsservice-governanceaccess_control-li><input type=checkbox id=m-docskitextutorialsservice-governanceaccess_control-check>
<label for=m-docskitextutorialsservice-governanceaccess_control-check><a href=/docs/kitex/tutorials/service-governance/access_control/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsservice-governanceaccess_control><span>Customized Access Control</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsobservability-li><input type=checkbox id=m-docskitextutorialsobservability-check>
<label for=m-docskitextutorialsobservability-check><a href=/docs/kitex/tutorials/observability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsobservability><span>Observability</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsobservabilityinstrumentation-li><input type=checkbox id=m-docskitextutorialsobservabilityinstrumentation-check>
<label for=m-docskitextutorialsobservabilityinstrumentation-check><a href=/docs/kitex/tutorials/observability/instrumentation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsobservabilityinstrumentation><span>Instrumentation Control</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsobservabilitytracing-li><input type=checkbox id=m-docskitextutorialsobservabilitytracing-check>
<label for=m-docskitextutorialsobservabilitytracing-check><a href=/docs/kitex/tutorials/observability/tracing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsobservabilitytracing><span>Tracing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsobservabilitylogging-li><input type=checkbox id=m-docskitextutorialsobservabilitylogging-check>
<label for=m-docskitextutorialsobservabilitylogging-check><a href=/docs/kitex/tutorials/observability/logging/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsobservabilitylogging><span>Logging</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docskitextutorialsadvanced-feature-li><input type=checkbox id=m-docskitextutorialsadvanced-feature-check checked>
<label for=m-docskitextutorialsadvanced-feature-check><a href=/docs/kitex/tutorials/advanced-feature/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsadvanced-feature><span>Advanced Feature</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featurepayload_validator-li><input type=checkbox id=m-docskitextutorialsadvanced-featurepayload_validator-check>
<label for=m-docskitextutorialsadvanced-featurepayload_validator-check><a href=/docs/kitex/tutorials/advanced-feature/payload_validator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featurepayload_validator><span>Payload Validator</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docskitextutorialsadvanced-featuregeneric-call-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregeneric-call-check checked>
<label for=m-docskitextutorialsadvanced-featuregeneric-call-check><a href=/docs/kitex/tutorials/advanced-feature/generic-call/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsadvanced-featuregeneric-call><span>Generic Call</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docskitextutorialsadvanced-featuregeneric-callbasic_usage-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregeneric-callbasic_usage-check checked>
<label for=m-docskitextutorialsadvanced-featuregeneric-callbasic_usage-check><a href=/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregeneric-callbasic_usage><span class=td-sidebar-nav-active-item>Basic Usage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuregeneric-callthrift_idl_annotation_standards-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregeneric-callthrift_idl_annotation_standards-check>
<label for=m-docskitextutorialsadvanced-featuregeneric-callthrift_idl_annotation_standards-check><a href=/docs/kitex/tutorials/advanced-feature/generic-call/thrift_idl_annotation_standards/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregeneric-callthrift_idl_annotation_standards><span>IDL Definition Specification for Mapping between Thrift and HTTP</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-dynamicgo-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-dynamicgo-check>
<label for=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-dynamicgo-check><a href=/docs/kitex/tutorials/advanced-feature/generic-call/generic-call-dynamicgo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-dynamicgo><span>User guide to generic call with dynamicgo</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-reflection-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-reflection-check>
<label for=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-reflection-check><a href=/docs/kitex/tutorials/advanced-feature/generic-call/generic-call-reflection/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregeneric-callgeneric-call-reflection><span>Use Thrift reflection to improve generic-call performance</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuremetainfo-li><input type=checkbox id=m-docskitextutorialsadvanced-featuremetainfo-check>
<label for=m-docskitextutorialsadvanced-featuremetainfo-check><a href=/docs/kitex/tutorials/advanced-feature/metainfo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuremetainfo><span>Metainfo</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featureinvoker-li><input type=checkbox id=m-docskitextutorialsadvanced-featureinvoker-check>
<label for=m-docskitextutorialsadvanced-featureinvoker-check><a href=/docs/kitex/tutorials/advanced-feature/invoker/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featureinvoker><span>Server SDK Mode</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featureerror_handler-li><input type=checkbox id=m-docskitextutorialsadvanced-featureerror_handler-check>
<label for=m-docskitextutorialsadvanced-featureerror_handler-check><a href=/docs/kitex/tutorials/advanced-feature/error_handler/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featureerror_handler><span>Customize Error Handler</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featurestart_shutdown_hook-li><input type=checkbox id=m-docskitextutorialsadvanced-featurestart_shutdown_hook-check>
<label for=m-docskitextutorialsadvanced-featurestart_shutdown_hook-check><a href=/docs/kitex/tutorials/advanced-feature/start_shutdown_hook/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featurestart_shutdown_hook><span>Customize Hook for Start/Shutdown of Server-side</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuregrpcproxy-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregrpcproxy-check>
<label for=m-docskitextutorialsadvanced-featuregrpcproxy-check><a href=/docs/kitex/tutorials/advanced-feature/grpcproxy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregrpcproxy><span>gRPC Proxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featurecodec_frugal-li><input type=checkbox id=m-docskitextutorialsadvanced-featurecodec_frugal-check>
<label for=m-docskitextutorialsadvanced-featurecodec_frugal-check><a href=/docs/kitex/tutorials/advanced-feature/codec_frugal/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featurecodec_frugal><span>Frugal</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featurexds-li><input type=checkbox id=m-docskitextutorialsadvanced-featurexds-check>
<label for=m-docskitextutorialsadvanced-featurexds-check><a href=/docs/kitex/tutorials/advanced-feature/xds/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featurexds><span>xDS Support</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featurefieldmask-li><input type=checkbox id=m-docskitextutorialsadvanced-featurefieldmask-check>
<label for=m-docskitextutorialsadvanced-featurefieldmask-check><a href=/docs/kitex/tutorials/advanced-feature/fieldmask/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featurefieldmask><span>Serialize Data Ondemands</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featureprofiler-li><input type=checkbox id=m-docskitextutorialsadvanced-featureprofiler-check>
<label for=m-docskitextutorialsadvanced-featureprofiler-check><a href=/docs/kitex/tutorials/advanced-feature/profiler/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featureprofiler><span>Request Profiler</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsadvanced-featuremulti_service-li><input type=checkbox id=m-docskitextutorialsadvanced-featuremulti_service-check>
<label for=m-docskitextutorialsadvanced-featuremulti_service-check><a href=/docs/kitex/tutorials/advanced-feature/multi_service/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsadvanced-featuremulti_service><span>Multiple Services</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuremulti_servicemulti_service-li><input type=checkbox id=m-docskitextutorialsadvanced-featuremulti_servicemulti_service-check>
<label for=m-docskitextutorialsadvanced-featuremulti_servicemulti_service-check><a href=/docs/kitex/tutorials/advanced-feature/multi_service/multi_service/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuremulti_servicemulti_service><span>Multiple Services</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuremulti_servicemulti_handler-li><input type=checkbox id=m-docskitextutorialsadvanced-featuremulti_servicemulti_handler-check>
<label for=m-docskitextutorialsadvanced-featuremulti_servicemulti_handler-check><a href=/docs/kitex/tutorials/advanced-feature/multi_service/multi_handler/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuremulti_servicemulti_handler><span>Generating Multiple Handlers for Multiple Services</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featuregls-li><input type=checkbox id=m-docskitextutorialsadvanced-featuregls-check>
<label for=m-docskitextutorialsadvanced-featuregls-check><a href=/docs/kitex/tutorials/advanced-feature/gls/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featuregls><span>GLS Feature Usage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsadvanced-featureproxy_application_development-li><input type=checkbox id=m-docskitextutorialsadvanced-featureproxy_application_development-check>
<label for=m-docskitextutorialsadvanced-featureproxy_application_development-check><a href=/docs/kitex/tutorials/advanced-feature/proxy_application_development/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsadvanced-featureproxy_application_development><span>Proxy Application Development</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialscode-gen-li><input type=checkbox id=m-docskitextutorialscode-gen-check>
<label for=m-docskitextutorialscode-gen-check><a href=/docs/kitex/tutorials/code-gen/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialscode-gen><span>Code Generation</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-gencode_generation-li><input type=checkbox id=m-docskitextutorialscode-gencode_generation-check>
<label for=m-docskitextutorialscode-gencode_generation-check><a href=/docs/kitex/tutorials/code-gen/code_generation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-gencode_generation><span>Code Generation Tool</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-gencombine_service-li><input type=checkbox id=m-docskitextutorialscode-gencombine_service-check>
<label for=m-docskitextutorialscode-gencombine_service-check><a href=/docs/kitex/tutorials/code-gen/combine_service/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-gencombine_service><span>Combine Service [DEPRECATED]</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genvalidator-li><input type=checkbox id=m-docskitextutorialscode-genvalidator-check>
<label for=m-docskitextutorialscode-genvalidator-check><a href=/docs/kitex/tutorials/code-gen/validator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genvalidator><span>Thrift Validator</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genfastpb-li><input type=checkbox id=m-docskitextutorialscode-genfastpb-check>
<label for=m-docskitextutorialscode-genfastpb-check><a href=/docs/kitex/tutorials/code-gen/fastpb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genfastpb><span>Fastpb</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-gentemplate_extension-li><input type=checkbox id=m-docskitextutorialscode-gentemplate_extension-check>
<label for=m-docskitextutorialscode-gentemplate_extension-check><a href=/docs/kitex/tutorials/code-gen/template_extension/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-gentemplate_extension><span>Extend the Templates of Service Generated Code</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genstruct_reference_generator-li><input type=checkbox id=m-docskitextutorialscode-genstruct_reference_generator-check>
<label for=m-docskitextutorialscode-genstruct_reference_generator-check><a href=/docs/kitex/tutorials/code-gen/struct_reference_generator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genstruct_reference_generator><span>Generate Structs Reference</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-gencustom_tpl-li><input type=checkbox id=m-docskitextutorialscode-gencustom_tpl-check>
<label for=m-docskitextutorialscode-gencustom_tpl-check><a href=/docs/kitex/tutorials/code-gen/custom_tpl/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-gencustom_tpl><span>Custom Scaffold Template</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genidl_trimmer-li><input type=checkbox id=m-docskitextutorialscode-genidl_trimmer-check>
<label for=m-docskitextutorialscode-genidl_trimmer-check><a href=/docs/kitex/tutorials/code-gen/idl_trimmer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genidl_trimmer><span>Thriftgo IDL Trimmer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genprotoc_validator-li><input type=checkbox id=m-docskitextutorialscode-genprotoc_validator-check>
<label for=m-docskitextutorialscode-genprotoc_validator-check><a href=/docs/kitex/tutorials/code-gen/protoc_validator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genprotoc_validator><span>Protoc Validator</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-gencustom_struct_tags-li><input type=checkbox id=m-docskitextutorialscode-gencustom_struct_tags-check>
<label for=m-docskitextutorialscode-gencustom_struct_tags-check><a href=/docs/kitex/tutorials/code-gen/custom_struct_tags/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-gencustom_struct_tags><span>Custom Struct Tags</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genskip_decoder-li><input type=checkbox id=m-docskitextutorialscode-genskip_decoder-check>
<label for=m-docskitextutorialscode-genskip_decoder-check><a href=/docs/kitex/tutorials/code-gen/skip_decoder/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genskip_decoder><span>SkipDecoder</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialscode-genprutal-li><input type=checkbox id=m-docskitextutorialscode-genprutal-check>
<label for=m-docskitextutorialscode-genprutal-check><a href=/docs/kitex/tutorials/code-gen/prutal/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialscode-genprutal><span>Prutal</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsframework-exten-li><input type=checkbox id=m-docskitextutorialsframework-exten-check>
<label for=m-docskitextutorialsframework-exten-check><a href=/docs/kitex/tutorials/framework-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsframework-exten><span>Framework Extension</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenmiddleware-li><input type=checkbox id=m-docskitextutorialsframework-extenmiddleware-check>
<label for=m-docskitextutorialsframework-extenmiddleware-check><a href=/docs/kitex/tutorials/framework-exten/middleware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenmiddleware><span>Middleware Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extensuite-li><input type=checkbox id=m-docskitextutorialsframework-extensuite-check>
<label for=m-docskitextutorialsframework-extensuite-check><a href=/docs/kitex/tutorials/framework-exten/suite/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extensuite><span>Suite Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenregistry-li><input type=checkbox id=m-docskitextutorialsframework-extenregistry-check>
<label for=m-docskitextutorialsframework-extenregistry-check><a href=/docs/kitex/tutorials/framework-exten/registry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenregistry><span>Extension of Service Registry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenservice_discovery-li><input type=checkbox id=m-docskitextutorialsframework-extenservice_discovery-check>
<label for=m-docskitextutorialsframework-extenservice_discovery-check><a href=/docs/kitex/tutorials/framework-exten/service_discovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenservice_discovery><span>Service Discovery Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenloadbalance-li><input type=checkbox id=m-docskitextutorialsframework-extenloadbalance-check>
<label for=m-docskitextutorialsframework-extenloadbalance-check><a href=/docs/kitex/tutorials/framework-exten/loadbalance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenloadbalance><span>Customize LoadBalancer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenmonitoring-li><input type=checkbox id=m-docskitextutorialsframework-extenmonitoring-check>
<label for=m-docskitextutorialsframework-extenmonitoring-check><a href=/docs/kitex/tutorials/framework-exten/monitoring/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenmonitoring><span>Monitoring Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extencodec-li><input type=checkbox id=m-docskitextutorialsframework-extencodec-check>
<label for=m-docskitextutorialsframework-extencodec-check><a href=/docs/kitex/tutorials/framework-exten/codec/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extencodec><span>Extension of Codec</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extentransport-li><input type=checkbox id=m-docskitextutorialsframework-extentransport-check>
<label for=m-docskitextutorialsframework-extentransport-check><a href=/docs/kitex/tutorials/framework-exten/transport/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extentransport><span>Extension of Transport Module</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extentrans_pipeline-li><input type=checkbox id=m-docskitextutorialsframework-extentrans_pipeline-check>
<label for=m-docskitextutorialsframework-extentrans_pipeline-check><a href=/docs/kitex/tutorials/framework-exten/trans_pipeline/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extentrans_pipeline><span>Extension of Transport Pipeline-Bound</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extentransmeta-li><input type=checkbox id=m-docskitextutorialsframework-extentransmeta-check>
<label for=m-docskitextutorialsframework-extentransmeta-check><a href=/docs/kitex/tutorials/framework-exten/transmeta/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extentransmeta><span>Extension of Metadata Transparent Transmission</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extendiagnosis-li><input type=checkbox id=m-docskitextutorialsframework-extendiagnosis-check>
<label for=m-docskitextutorialsframework-extendiagnosis-check><a href=/docs/kitex/tutorials/framework-exten/diagnosis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extendiagnosis><span>Extension of Diagnosis</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsframework-extenimplemented_extension-li><input type=checkbox id=m-docskitextutorialsframework-extenimplemented_extension-check>
<label for=m-docskitextutorialsframework-extenimplemented_extension-check><a href=/docs/kitex/tutorials/framework-exten/implemented_extension/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsframework-extenimplemented_extension><span>Implemented Extension</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsoptions-li><input type=checkbox id=m-docskitextutorialsoptions-check>
<label for=m-docskitextutorialsoptions-check><a href=/docs/kitex/tutorials/options/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsoptions><span>Option</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsoptionsclient_options-li><input type=checkbox id=m-docskitextutorialsoptionsclient_options-check>
<label for=m-docskitextutorialsoptionsclient_options-check><a href=/docs/kitex/tutorials/options/client_options/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsoptionsclient_options><span>Client Option</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsoptionsserver_options-li><input type=checkbox id=m-docskitextutorialsoptionsserver_options-check>
<label for=m-docskitextutorialsoptionsserver_options-check><a href=/docs/kitex/tutorials/options/server_options/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsoptionsserver_options><span>Server Option</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsoptionscall_options-li><input type=checkbox id=m-docskitextutorialsoptionscall_options-check>
<label for=m-docskitextutorialsoptionscall_options-check><a href=/docs/kitex/tutorials/options/call_options/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsoptionscall_options><span>Call Option</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsthird-party-li><input type=checkbox id=m-docskitextutorialsthird-party-check>
<label for=m-docskitextutorialsthird-party-check><a href=/docs/kitex/tutorials/third-party/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsthird-party><span>Third-Party</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsthird-partyservice_discovery-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discovery-check>
<label for=m-docskitextutorialsthird-partyservice_discovery-check><a href=/docs/kitex/tutorials/third-party/service_discovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsthird-partyservice_discovery><span>Service Discovery</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryetcd-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryetcd-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryetcd-check><a href=/docs/kitex/tutorials/third-party/service_discovery/etcd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryetcd><span>Etcd</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryconsul-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryconsul-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryconsul-check><a href=/docs/kitex/tutorials/third-party/service_discovery/consul/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryconsul><span>Consul</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryeureka-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryeureka-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryeureka-check><a href=/docs/kitex/tutorials/third-party/service_discovery/eureka/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryeureka><span>Eureka</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoverynacos-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoverynacos-check>
<label for=m-docskitextutorialsthird-partyservice_discoverynacos-check><a href=/docs/kitex/tutorials/third-party/service_discovery/nacos/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoverynacos><span>Nacos</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoverypolaris-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoverypolaris-check>
<label for=m-docskitextutorialsthird-partyservice_discoverypolaris-check><a href=/docs/kitex/tutorials/third-party/service_discovery/polaris/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoverypolaris><span>Polaris</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryservice-comb-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryservice-comb-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryservice-comb-check><a href=/docs/kitex/tutorials/third-party/service_discovery/service-comb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryservice-comb><span>ServiceComb</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryzookeeper-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryzookeeper-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryzookeeper-check><a href=/docs/kitex/tutorials/third-party/service_discovery/zookeeper/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryzookeeper><span>Zookeeper</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoverydns-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoverydns-check>
<label for=m-docskitextutorialsthird-partyservice_discoverydns-check><a href=/docs/kitex/tutorials/third-party/service_discovery/dns/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoverydns><span>DNS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyservice_discoveryrule-based-li><input type=checkbox id=m-docskitextutorialsthird-partyservice_discoveryrule-based-check>
<label for=m-docskitextutorialsthird-partyservice_discoveryrule-based-check><a href=/docs/kitex/tutorials/third-party/service_discovery/rule-based/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyservice_discoveryrule-based><span>Service Filtering</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialsthird-partyconfig-center-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-center-check>
<label for=m-docskitextutorialsthird-partyconfig-center-check><a href=/docs/kitex/tutorials/third-party/config-center/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialsthird-partyconfig-center><span>ConfigCenter</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centeretcd-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centeretcd-check>
<label for=m-docskitextutorialsthird-partyconfig-centeretcd-check><a href=/docs/kitex/tutorials/third-party/config-center/etcd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centeretcd><span>Etcd</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centerapollo-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centerapollo-check>
<label for=m-docskitextutorialsthird-partyconfig-centerapollo-check><a href=/docs/kitex/tutorials/third-party/config-center/apollo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centerapollo><span>Apollo</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centernacos-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centernacos-check>
<label for=m-docskitextutorialsthird-partyconfig-centernacos-check><a href=/docs/kitex/tutorials/third-party/config-center/nacos/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centernacos><span>Nacos</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centerfile-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centerfile-check>
<label for=m-docskitextutorialsthird-partyconfig-centerfile-check><a href=/docs/kitex/tutorials/third-party/config-center/file/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centerfile><span>File</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centerzookeeper-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centerzookeeper-check>
<label for=m-docskitextutorialsthird-partyconfig-centerzookeeper-check><a href=/docs/kitex/tutorials/third-party/config-center/zookeeper/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centerzookeeper><span>Zookeeper</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyconfig-centerconsul-li><input type=checkbox id=m-docskitextutorialsthird-partyconfig-centerconsul-check>
<label for=m-docskitextutorialsthird-partyconfig-centerconsul-check><a href=/docs/kitex/tutorials/third-party/config-center/consul/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyconfig-centerconsul><span>Consul</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialsthird-partyobservability-li><input type=checkbox id=m-docskitextutorialsthird-partyobservability-check>
<label for=m-docskitextutorialsthird-partyobservability-check><a href=/docs/kitex/tutorials/third-party/observability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialsthird-partyobservability><span>Observability</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitextutorialstool-li><input type=checkbox id=m-docskitextutorialstool-check>
<label for=m-docskitextutorialstool-check><a href=/docs/kitex/tutorials/tool/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitextutorialstool><span>Tool</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitextutorialstoolkitexcall-li><input type=checkbox id=m-docskitextutorialstoolkitexcall-check>
<label for=m-docskitextutorialstoolkitexcall-check><a href=/docs/kitex/tutorials/tool/kitexcall/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitextutorialstoolkitexcall><span>kitexcall: the CLI tool for sending RPC call in JSON format</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitexreference-li><input type=checkbox id=m-docskitexreference-check checked>
<label for=m-docskitexreference-check><a href=/docs/kitex/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexreference><span>Reference</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexreferencetransport_protocol_ttheader-li><input type=checkbox id=m-docskitexreferencetransport_protocol_ttheader-check>
<label for=m-docskitexreferencetransport_protocol_ttheader-check><a href=/docs/kitex/reference/transport_protocol_ttheader/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexreferencetransport_protocol_ttheader><span>TTHeader</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexreferenceexception-li><input type=checkbox id=m-docskitexreferenceexception-check>
<label for=m-docskitexreferenceexception-check><a href=/docs/kitex/reference/exception/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexreferenceexception><span>Exception Instruction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexreferenceversion-li><input type=checkbox id=m-docskitexreferenceversion-check>
<label for=m-docskitexreferenceversion-check><a href=/docs/kitex/reference/version/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexreferenceversion><span>Version Specification</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitexbest-practice-li><input type=checkbox id=m-docskitexbest-practice-check checked>
<label for=m-docskitexbest-practice-check><a href=/docs/kitex/best-practice/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexbest-practice><span>Best Practice</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceusage_attention-li><input type=checkbox id=m-docskitexbest-practiceusage_attention-check>
<label for=m-docskitexbest-practiceusage_attention-check><a href=/docs/kitex/best-practice/usage_attention/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceusage_attention><span>Usage Attention</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practicegraceful_shutdown-li><input type=checkbox id=m-docskitexbest-practicegraceful_shutdown-check>
<label for=m-docskitexbest-practicegraceful_shutdown-check><a href=/docs/kitex/best-practice/graceful_shutdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practicegraceful_shutdown><span>Graceful Shutdown</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceerror_handle-li><input type=checkbox id=m-docskitexbest-practiceerror_handle-check>
<label for=m-docskitexbest-practiceerror_handle-check><a href=/docs/kitex/best-practice/error_handle/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceerror_handle><span>Error Handle</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceremove_apache_codec-li><input type=checkbox id=m-docskitexbest-practiceremove_apache_codec-check>
<label for=m-docskitexbest-practiceremove_apache_codec-check><a href=/docs/kitex/best-practice/remove_apache_codec/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceremove_apache_codec><span>Kitex Remove Apache Thrift User Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitexbest-practiceintegration-testing-li><input type=checkbox id=m-docskitexbest-practiceintegration-testing-check>
<label for=m-docskitexbest-practiceintegration-testing-check><a href=/docs/kitex/best-practice/integration-testing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexbest-practiceintegration-testing><span>Integration Testing</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceintegration-testingmock_client-li><input type=checkbox id=m-docskitexbest-practiceintegration-testingmock_client-check>
<label for=m-docskitexbest-practiceintegration-testingmock_client-check><a href=/docs/kitex/best-practice/integration-testing/mock_client/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceintegration-testingmock_client><span>How To Mock A Kitex Client</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceintegration-testingdebug_efficiently-li><input type=checkbox id=m-docskitexbest-practiceintegration-testingdebug_efficiently-check>
<label for=m-docskitexbest-practiceintegration-testingdebug_efficiently-check><a href=/docs/kitex/best-practice/integration-testing/debug_efficiently/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceintegration-testingdebug_efficiently><span>Debug Efficiently</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docskitexbest-practiceself_check-li><input type=checkbox id=m-docskitexbest-practiceself_check-check>
<label for=m-docskitexbest-practiceself_check-check><a href=/docs/kitex/best-practice/self_check/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexbest-practiceself_check><span>Self Troubleshooting Guide</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceself_checkpanic_self_check-li><input type=checkbox id=m-docskitexbest-practiceself_checkpanic_self_check-check>
<label for=m-docskitexbest-practiceself_checkpanic_self_check-check><a href=/docs/kitex/best-practice/self_check/panic_self_check/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceself_checkpanic_self_check><span>Panic Self-check Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceself_checkmem_leak_self_check-li><input type=checkbox id=m-docskitexbest-practiceself_checkmem_leak_self_check-check>
<label for=m-docskitexbest-practiceself_checkmem_leak_self_check-check><a href=/docs/kitex/best-practice/self_check/mem_leak_self_check/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceself_checkmem_leak_self_check><span>Memory Leak Self-Check Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexbest-practiceself_checkfast_write_read_panic-li><input type=checkbox id=m-docskitexbest-practiceself_checkfast_write_read_panic-check>
<label for=m-docskitexbest-practiceself_checkfast_write_read_panic-check><a href=/docs/kitex/best-practice/self_check/fast_write_read_panic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docskitexbest-practiceself_checkfast_write_read_panic><span>FastWrite/FastRead Panic Error</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docskitexfaq-li><input type=checkbox id=m-docskitexfaq-check checked>
<label for=m-docskitexfaq-check><a href=/docs/kitex/faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docskitexfaq><span>FAQ</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en/docs/kitex/Tutorials/advanced-feature/generic-call/basic_usage.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en/docs/kitex/Tutorials/advanced-feature/generic-call?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?title=Basic%20Usage" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/kitex/issues/new/choose class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#what-is-generic-call>What is Generic Call?</a></li><li><a href=#supported-scenarios>Supported Scenarios</a></li><li><a href=#usage-examples>Usage Examples</a><ul><li><a href=#idlprovider>IDLProvider</a></li><li><a href=#thrift-binary-generic---v2-interface>Thrift Binary Generic - V2 Interface</a></li><li><a href=#deprecated-thrift-binary-generic>[DEPRECATED] Thrift Binary Generic</a></li><li><a href=#protobuf-binary-generic-call>Protobuf Binary Generic Call</a></li><li><a href=#http-mapping-generic-call>HTTP Mapping Generic Call</a></li><li><a href=#map-mapping-generic-call>Map Mapping Generic Call</a></li><li><a href=#json-mapping-generic-call>JSON Mapping Generic Call</a></li><li><a href=#performance-benchmark-comparison>Performance Benchmark Comparison</a></li><li><a href=#faq>FAQ</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/kitex/>Kitex</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/kitex/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/kitex/tutorials/advanced-feature/>Advanced Feature</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/kitex/tutorials/advanced-feature/generic-call/>Generic Call</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://www.cloudwego.io/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/>Basic Usage</a></li></ol></nav><div class=td-content><h1>Basic Usage</h1><div class=lead>Complete guide to Kitex generic calls including binary forwarding, HTTP mapping, Map/JSON mapping, and Protobuf binary generic calls.</div><header class=article-meta></header><blockquote><p>For stream calls, please upgrade <strong>github.com/cloudwego/kitex</strong> to >= v0.14.1</p></blockquote><h2 id=what-is-generic-call>What is Generic Call?</h2><p>In a standard Kitex Client -> Kitex Server request, the business code can directly construct a Go struct (the method&rsquo;s Request), call the corresponding method of the Kitex Client, perform serialization within the method, and then send it to the Server.</p><p>In some scenarios, the business code might receive:</p><ul><li><p>Already encoded binary data (e.g., in a proxy)</p><ul><li>The data needs to be directly forwarded to the target Server without being decoded and reconstructed.</li></ul></li><li><p>HTTP Request, Go map, or JSON (e.g., in an ApiGateway)</p><ul><li>The binary data resulting from the serialization of this data needs to be sent to the target Server.</li></ul></li></ul><p>In these scenarios, there may be multiple target downstream services/methods, and it is impossible (or unsuitable) for the business code to construct a Go struct for each piece of data. Therefore, Kitex&rsquo;s generic call capability is needed.</p><h2 id=supported-scenarios>Supported Scenarios</h2><ol><li><strong>Thrift Binary Forwarding</strong>: For traffic forwarding scenarios.</li><li><strong>HTTP-Mapping Generic Call</strong>: For API gateway scenarios (non-streaming only).</li><li><strong>Protobuf Binary Generic Call</strong></li><li><strong>Map-Thrift Mapping Generic Call</strong></li><li><strong>JSON-Mapping Generic Call</strong>: Supports mapping to thrift / protobuf.</li></ol><h2 id=usage-examples>Usage Examples</h2><h3 id=idlprovider>IDLProvider</h3><p>Generic calls require a runtime descriptor from the IDL, which is provided by an <code>IDLProvider</code>. Kitex currently offers two <code>IDLProvider</code> implementations.</p><h4 id=parsing-local-files>Parsing Local Files</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// equals to `kitex -I /idl ./Your_IDL_File_Path`</span>
</span></span><span style=display:flex><span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./Your_IDL_File_Path&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/idl&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>     <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=parsing-in-memory-content-update-cloudwegokitex--v0130>Parsing In-Memory Content (update cloudwego/kitex >= v0.13.0)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// equals to `kitex -I . a/a.thrift`</span>
</span></span><span style=display:flex><span><span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>NewThriftContentWithAbsIncludePathProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;a/a.thrift&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;a/a.thrift&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>`include &#34;../b/b.thrift&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      namespace go a.b.c`</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;b/b.thrift&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;namespace go a.b.c&#34;</span><span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>UpdateIDL</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;a/a.thrift&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;a/a.thrift&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>`include &#34;b/b.thrift&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      namespace go a.b.c`</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;b/b.thrift&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;namespace go a.b.c&#34;</span><span style=color:#000;font-weight:700>})</span>
</span></span></code></pre></div><p>The first argument of <code>NewThriftContentWithAbsIncludePathProvider</code> is the main IDL filename, and the second is a map from filenames to their content. This interface first tries to find included files using relative paths based on the main IDL file. If not found, it then uses absolute paths (i.e., directly looking up the IDL content using the filename as the key, as shown in <code>UpdateIDL</code>).</p><h4 id=testcase>Testcase</h4><p>Test case: <a href=https://github.com/cloudwego/kitex/blob/develop/pkg/generic/thriftidl_provider_test.go>https://github.com/cloudwego/kitex/blob/develop/pkg/generic/thriftidl_provider_test.go</a></p><h3 id=thrift-binary-generic---v2-interface>Thrift Binary Generic - V2 Interface</h3><p>For proxy applications, Kitex provides a best practice guide, please refer to: <a href=/docs/kitex/tutorials/advanced-feature/proxy_application_development/>Proxy Application Development Guide</a>.</p><p>Thrift Binary Generic Call V2 interface requires cloudwego/kitex >= v0.15.1.</p><h4 id=client-usage>Client Usage</h4><h5 id=initialize-client>Initialize Client</h5><p>Note: <strong>Do not</strong> create a new Client for each request (as each client consumes extra resources). It is recommended to create one client for each downstream service when the process starts, or use a Client Pool indexed by the downstream service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// service is the downstream service name, while idlServiceName is the name defined in the thrift/pb idl.</span>
</span></span><span style=display:flex><span><span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>service</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BinaryThriftGenericV2</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>idlServiceName</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeaderStreaming</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>Note that the thrift binary generic interface must specify the IDL service name, which corresponds to a service defined within an IDL. A client can only access RPC methods of a specific IDL service.</p><p>If the client needs to support streaming generic calls, you need to confirm the streaming call protocol. By default, the generic client generated through the above method uses TTHeaderStreaming for streaming protocols, while non-streaming messages use Framed or TTHeaderFramed. If you need to configure streaming methods to use GRPC protocol without changing the protocol of non-streaming methods, add the following client options:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GRPCStreaming</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h5 id=unary-generic-call>Unary Generic Call</h5><p>Note: Binary encoding does not encode the original Thrift request parameters (example: api.Request), but rather encapsulates the method parameters in KitexArgs (also a struct generated in kitex_gen from IDL, example: api.HelloEchoArgs).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/bytedance/gopkg/lang/dirtmake&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/frugal&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Construct a request parameter MethodArgs</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Note: type generated under kitex_gen, MethodArgs encapsulates MethodReq</span>
</span></span><span style=display:flex><span><span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>HelloEchoArgs</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>Req</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodedSize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>args</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>buf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dirtmake</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Bytes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Obtain the encoded Thrift binary from some method (not containing thrift header), directly call the generic Client to request downstream</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>methodName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>HelloEchoResult</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span><span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DecodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.([]</span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h5 id=streaming-generic-call>Streaming Generic Call</h5><p>Kitex streaming interface&rsquo;s binary payload is the value after raw request/response serialization, without Args/Results struct encapsulation, which differs from the unary interface. The streaming interface provides three streaming call modes. For detailed usage, see: <a href=/docs/kitex/tutorials/basic-feature/streamx/>StreamX Basic Stream Programming</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/bytedance/gopkg/lang/dirtmake&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/frugal&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>req</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodedSize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>buf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dirtmake</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Bytes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BidirectionalStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>methodName</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>rbuf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Recv</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>Response</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span><span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DecodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>rbuf</span><span style=color:#000;font-weight:700>.([]</span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h4 id=server-usage>Server Usage</h4><p>Since the thrift binary generic V2 interface must强制 specify the idl service name, and the idl service name must be carried by header protocols such as ttheader/grpc header/ttstream header, traffic from protocols like framed/buffered cannot carry idl service name and may not hit these specified idl service names, which could cause server processing errors.</p><p>Therefore, for thrift binary generic servers, Kitex framework recommends using the built-in UnknownServiceOrMethodHandler. Detailed usage is as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithListener</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ln</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>svr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterUnknownServiceOrMethodHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>svr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>UnknownServiceOrMethodHandler</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>DefaultHandler</span><span style=color:#000;font-weight:700>:</span>   <span style=color:#000>defaultUnknownHandler</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>StreamingHandler</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>streamingUnknownHandler</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span>
</span></span></code></pre></div><p>The <code>genericserver.UnknownServiceOrMethodHandler</code> needs to be injected with server handlers as needed. If the server does not receive streaming/grpc traffic, only inject the DefaultHandler; otherwise, you also need to inject the StreamingHandler. At least one of these two handlers must be injected.</p><h5 id=defaulthandler>DefaultHandler</h5><p>The DefaultHandler injects the server handler for handling ping-pong traffic (excluding grpc unary traffic), which is the familiar kitex standard RPC mode. This usually includes buffered/framed/ttheader traffic, supporting thrift and protobuf message protocols. Here&rsquo;s an example using thrift idl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/bytedance/gopkg/lang/dirtmake&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/frugal&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>defaultUnknownHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>service</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>request</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>response</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>HelloEchoArgs</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DecodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#000;font-weight:700>.([]</span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>req</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Req</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>req</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;req is nil&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>runner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ProcessRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>HelloEchoResult</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>Success</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodedSize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>buf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dirtmake</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Bytes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>According to the handler method signature, service is the service name defined in the IDL. If the request does not carry IDL Service name, the parameter value is empty.</p><h5 id=streaminghandler>StreamingHandler</h5><p>The StreamingHandler injects the server handler for all streaming methods (including grpc unary traffic), which is streaming RPC mode traffic. This usually includes grpc/ttstream traffic, supporting thrift and protobuf message formats. Here&rsquo;s an example using thrift:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>streamingUnknownHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>service</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>stream</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BidiStreamingServer</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>request</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Recv</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>io</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EOF</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>req</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DecodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#000;font-weight:700>.([]</span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>runner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ProcessRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodedSize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>buf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dirtmake</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Bytes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>frugal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EncodeObject</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Due to the lack of IDL Info, all binary traffic received by binary generic servers is treated as bidirectional streaming. Users need to ensure that the actual sending/receiving streaming mode is consistent with the IDL definition, otherwise it will cause processing errors on the peer side.</p><h5 id=unknown-handler>Unknown Handler</h5><p>If the service itself has already defined services, such as creating a server through the generated code&rsquo;s NewServer function, or injecting services through json/map and other generic call interfaces:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>svr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicea</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// register multi services</span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>serviceb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterService</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>svr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ServiceBImpl</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>Then when injecting unknown service handler again, all traffic that originally returned &ldquo;unknown service&rdquo; or &ldquo;unknown method&rdquo; errors when the client called this server will be received and processed by the unknownHandler.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterUnknownServiceOrMethodHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>svr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>unknownHandler</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=deprecated-thrift-binary-generic>[DEPRECATED] Thrift Binary Generic</h3><p>This requires users to encode the data themselves or to forward message packets in traffic forwarding scenarios. Binary generic calls only support Framed or TTHeader requests, not Buffered Binary.</p><p>Note: Oneway methods are not supported.</p><h4 id=client-side-usage>Client-side Usage</h4><h5 id=initialize-the-client>Initialize the Client</h5><p>Note: <strong>Do not</strong> create a new Client for each request (as each client consumes extra resources). It is recommended to create one client for each downstream service when the process starts, or use a Client Pool indexed by the downstream service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>service</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BinaryThriftGeneric</span><span style=color:#000;font-weight:700>(),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h5 id=generic-call>Generic Call</h5><p>Usage can be referenced at: <a href=https://github.com/cloudwego/kitex/blob/develop/pkg/generic/binary_test/generic_test.go#L117>https://github.com/cloudwego/kitex/blob/develop/pkg/generic/binary_test/generic_test.go#L117</a></p><p>Note: Binary encoding does not encode the original Thrift request parameters (example: api.Request), but rather encapsulates the method parameters in KitexArgs (also a struct generated in kitex_gen from IDL, example: api.HelloEchoArgs).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#000>gopkg</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/gopkg/protocol/thrift&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Use the thrift encoding/decoding package provided by kitex to construct an encoded Thrift binary ([]byte)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Need to satisfy thrift encoding format thrift/thrift-binary-protocol.md</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Construct a request parameter MethodArgs</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Note: type generated under kitex_gen, MethodArgs encapsulates MethodReq</span>
</span></span><span style=display:flex><span><span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>HelloEchoArgs</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Req</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>Request</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Message</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>buf</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>byte</span>
</span></span><span style=display:flex><span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gopkg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MarshalFastMsg</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>methodName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gopkg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CALL</span><span style=color:#000;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>/*seqID*/</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The above code is only for demonstrating how to get Thrift Binary</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The actual scenario for binary generic calls is often directly obtaining Thrift Binary</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Obtain the encoded Thrift binary from some method, directly call the generic Client to request downstream</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>methodName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Note: seqID is the request sequence number. The SeqID set by the user here will not take effect; the framework will generate and reset it, so just write 0. Server scenarios need to actively set seqID, specifically see the server section.</p><p>The returned result has a surface type of interface{}, actual type is []uint8, which is the thrift payload in the server response, and can be decoded to the KitexResult type.</p><h4 id=server-usage-if-needed>Server Usage (if needed)</h4><p>Used for servers that only do traffic forwarding.</p><p>The binary generic upstream client and downstream server do not need to be used in pairs. A binary generic server can accept normal Thrift requests, but the accepted protocol must be Framed or TTHeader, not Buffered Binary.</p><p>Reason: Binary generic does not parse Thrift packets, so it needs protocols with headers to handle them.</p><p>If the client passes the correct thrift encoded binary, it can access normal Thrift servers.</p><p>Note the usage in the following scenario:
Scenario: normal client -> [generic server-> generic client]-> normal server, you need to ensure that the packet returned by the generic server to the upstream has consistent seqID, otherwise it will cause upstream errors.</p><p>Handling method: Get the upstream seqID through <code>generic.GetSeqID(buff)</code>, after the generic server receives the buff returned by the generic client, reset the seqID of the data packet returned to the upstream through <code>generic.SetSeqID(seqID, transBuff)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BinaryThriftGeneric</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>GenericServiceImpl</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Run</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>GenericServiceImpl</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// GenericCall ...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>GenericServiceImpl</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>request</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>response</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// thrift protocol binary format, reference: thrift/thrift-binary-protocol.md</span>
</span></span><span style=display:flex><span>    <span style=color:#000>reqBuf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>request</span><span style=color:#000;font-weight:700>.([]</span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// method name is already parsed</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// e.g.</span>
</span></span><span style=display:flex><span>    <span style=color:#000>seqID</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetSeqID</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>reqBuf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// theoretically impossible, request packet is illegal</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Assume proxy scenario - request target downstream</span>
</span></span><span style=display:flex><span>    <span style=color:#000>respBuf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>methodName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>reqBuf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Execute handler logic</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct a respBuf: 1. Serialize the downstream return 2. // Can also be the return of binary generic call, satisfying &#34;request passthrough&#34; requirements</span>
</span></span><span style=display:flex><span>    <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SetSeqID</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>seqID</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>respBuf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>respBuf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=protobuf-binary-generic-call>Protobuf Binary Generic Call</h3><p>For proxy applications, Kitex provides a best practice guide, please refer to: <a href=/docs/kitex/tutorials/advanced-feature/proxy_application_development/>Proxy Application Development Guide</a>.</p><p>Protobuf Binary Generic Call supports streaming and non-streaming calls, requiring cloudwego/kitex >= v0.15.1.</p><h4 id=client-usage-1>Client Usage</h4><h5 id=initialize-client-1>Initialize Client</h5><p>Note: <strong>Do not</strong> create a new Client for each request (as each client consumes extra resources). It is recommended to create one client for each downstream service when the process starts, or use a Client Pool indexed by the downstream service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BinaryPbGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serviceName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>packageName</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>service</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeaderStreaming</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>Where serviceName and packageName correspond to the service name and package name defined in the idl, such as &ldquo;Mock&rdquo; and &ldquo;protobuf/pbapi&rdquo; in the following pb idl.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=display:flex><span><span style=color:#000>syntax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;proto3&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>pbapi</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;protobuf/pbapi&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>MockReq</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#204a87;font-weight:700>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>MockResp</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#204a87;font-weight:700>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>Mock</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>UnaryTest</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>MockReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>MockResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>ClientStreamingTest</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span> <span style=color:#000>MockReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>MockResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>ServerStreamingTest</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>MockReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span> <span style=color:#000>MockResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>BidirectionalStreamingTest</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span> <span style=color:#000>MockReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>stream</span> <span style=color:#000>MockResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>If the client needs to support streaming generic calls, you need to confirm the streaming call protocol. By default, the generic client generated through the above method uses TTHeaderStreaming for streaming protocols, while non-streaming messages use Framed or TTHeaderFramed. If you need to configure to use GRPC protocol, add the following client options:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BinaryThriftGeneric</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GRPC</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h5 id=generic-call-1>Generic Call</h5><p>The request/response or stream message passed in generic calls are the results after protobuf serialization. After the generic client is initialized, it provides 4 streaming mode call methods. For detailed streaming usage, see: <a href=/docs/kitex/tutorials/basic-feature/streamx/>StreamX Basic Stream Programming</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// unary</span>
</span></span><span style=display:flex><span><span style=color:#000>resp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;UnaryTest&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// client streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ClientStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// server streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ServerStreamingTest&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// bidi streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BidirectionalStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;BidirectionalStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Detailed usage example: <a href=https://github.com/cloudwego/kitex-tests/blob/main/generic/binarypb/generic_test.go>https://github.com/cloudwego/kitex-tests/blob/main/generic/binarypb/generic_test.go</a></p><h4 id=server-usage-1>Server Usage</h4><p>Since the protobuf binary generic interface must specify the idl service name, and the idl service name must be carried by header protocols such as ttheader/grpc header/ttstream header, traffic from protocols like framed/buffered (kitex-protobuf) cannot carry idl service name and may not hit these specified idl service names, which could cause server processing errors.</p><p>Therefore, for protobuf binary generic servers, the recommended usage is to use the built-in UnknownServiceOrMethodHandler. For its usage, please refer to the thrift binary generic - server usage section. The usage of protobuf and thrift is completely consistent, only the message encoding format differs.</p><h4 id=unknown-handler-1>Unknown Handler</h4><p>For unknown handler, also refer to thrift binary generic - unknown handler.</p><h3 id=http-mapping-generic-call>HTTP Mapping Generic Call</h3><p>Note: Only supports generic clients, converting HTTP Request to Thrift request, and will convert downstream Thrift return to HTTP Response.</p><p>Kitex now supports higher performance generic call implementation, usage see <a href=../generic-call-dynamicgo/>Generic Call Access DynamicGo Guide</a>.</p><h4 id=generic-call-example-data-format-is-json>Generic Call Example (data format is json)</h4><p><strong>YOUR_IDL.thrift</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=display:flex><span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>http</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ReqItem</span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>go.tag</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;json:</span><span style=color:#4e9a06>\&#34;</span><span style=color:#4e9a06>id</span><span style=color:#4e9a06>\&#34;</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>text</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v_int64</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;v_int64&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.vd</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;$&gt;0&amp;&amp;$&lt;200&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>text</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;text&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>token</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.header</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;token&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ReqItem</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>req_items_map</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;req_items_map&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ReqItem</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>some</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;some&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>req_items</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;req_items&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api_version</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.path</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;action&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>uid</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.path</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;biz&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cids</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;cids&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>vids</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;vids&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RspItem</span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>item_id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>text</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizResponse</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>T</span>                             <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.header</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;T&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RspItem</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rsp_items</span>           <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;rsp_items&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v_enum</span>                       <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.none</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>RspItem</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rsp_item_list</span>            <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;rsp_item_list&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>http_code</span>                         <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.http_code</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>item_count</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.header</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;item_count&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizService</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>BizResponse</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizMethod1</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>api.get</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;/life/client/:action/:biz&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.baseurl</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;ib.snssdk.com&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.param</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>BizResponse</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizMethod2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>api.post</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;/life/client/:action/:biz&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.baseurl</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;ib.snssdk.com&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.param</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.serializer</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;form&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>BizResponse</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizMethod3</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BizRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>api.post</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;/life/client/:action/:biz/other&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.baseurl</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;ib.snssdk.com&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.param</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.serializer</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;json&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><strong>Request</strong>
Type: *generic.HTTPRequest</p><p><strong>Response</strong>
Type: *generic.HTTPResponse</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Local file idl parsing</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// YOUR_IDL_PATH thrift file path: example ./idl/example.thrift</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// includeDirs: specify include paths, default uses relative path of current file to find includes</span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct http type generic call</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HTTPThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct request</span>
</span></span><span style=display:flex><span>    <span style=color:#000>body</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;some&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span>   <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;req_items_map&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                                <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span>   <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;text&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>json</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Marshal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;http://example.com/life/client/1/1?v_int64=1&amp;req_items=item1,item2,itme3&amp;cids=1,2,3&amp;vids=1,2,3&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>req</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>bytes</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewBuffer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;token&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>customReq</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>FromHTTPRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// Considering that business may use third-party http request, you can construct conversion function yourself</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// customReq *generic.HTTPRequest</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Since the method for http generic is obtained from http request through bam rules, just fill in empty</span>
</span></span><span style=display:flex><span>    <span style=color:#000>resp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>customReq</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>realResp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HTTPResponse</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>realResp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Write</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// Write back ResponseWriter, used for http gateway</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=map-mapping-generic-call>Map Mapping Generic Call</h3><p>Map mapping generic call means that users can directly construct Map request parameters or returns according to the specification, and Kitex will complete Thrift encoding and decoding accordingly.</p><p>Note: For users with high performance requirements, consider <a href=../generic-call-reflection/>Using Thrift Dynamic Reflection to Improve Generic Call Performance</a>.</p><h4 id=map-construction>Map Construction</h4><p>Kitex will strictly validate the field names and types constructed by users according to the given IDL. Field names only support string type corresponding to Map Key (map key优先取json tag定义的值，其次取字段名，参考 特别说明 - JSON泛化 一节), and the type mapping of field Value is shown in the table below.</p><p>For returns, the Response&rsquo;s Field ID and type will be validated, and the corresponding Map Key will be generated according to the Field Name of the IDL.</p><h4 id=type-mapping>Type Mapping</h4><p>Golang 与 Thrift IDL 类型映射如下：</p><p><strong>Write Mapping</strong></p><table><thead><tr><th>Golang Type</th><th>Thrift IDL Type</th></tr></thead><tbody><tr><td>bool</td><td>bool</td></tr><tr><td>int8, byte</td><td>i8, byte</td></tr><tr><td>int16</td><td>i16</td></tr><tr><td>int32</td><td>i32, i16, i8</td></tr><tr><td>int64</td><td>i64</td></tr><tr><td>float64</td><td>double, i64, i32, i16, i8</td></tr><tr><td>string</td><td>string,binary</td></tr><tr><td>[]byte</td><td>binary,string</td></tr><tr><td>[]interface{}</td><td>list/set</td></tr><tr><td>map[interface{}]interface{}</td><td>map</td></tr><tr><td>map[string]interface{}</td><td>struct</td></tr><tr><td>int32</td><td>enum</td></tr></tbody></table><p><strong>Read Mapping</strong></p><table><thead><tr><th>Thrift IDL Type</th><th>Golang Type (read)</th><th>Remarks</th></tr></thead><tbody><tr><td>bool</td><td>bool</td><td></td></tr><tr><td>i8,</td><td>int8</td><td></td></tr><tr><td>byte</td><td>byte</td><td></td></tr><tr><td>i16</td><td>int16</td><td></td></tr><tr><td>i32</td><td>int32</td><td></td></tr><tr><td>i64</td><td>int64</td><td></td></tr><tr><td>double</td><td>float64</td><td></td></tr><tr><td>string</td><td>string</td><td></td></tr><tr><td>binary</td><td>[]byte</td><td>Default return is String, if you need to return []byte, you need to set through SetBinaryWithByteSlice.</td></tr><tr><td>list/set</td><td>[]interface{}</td><td></td></tr><tr><td>map</td><td>map[interface{}]interface{}</td><td></td></tr><tr><td>struct</td><td>map[string]interface{}</td><td></td></tr><tr><td>enum</td><td>int32</td><td></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MapThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SetBinaryWithByteSlice</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h4 id=data-example>Data Example</h4><p>Take the following IDL as an example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=display:flex><span><span style=color:#204a87;font-weight:700>enum</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>SUCCESS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>FAILURE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Map</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ID</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>EchoRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Msg</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>i8</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i16</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I16</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I32</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I64</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>binary</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Binary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Map</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>set</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Set</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>List</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>255</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Base</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Base</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Construct the request as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>req</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;Msg&#34;</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;I8&#34;</span><span style=color:#000;font-weight:700>:</span>     <span style=color:#204a87>int8</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;I16&#34;</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#204a87>int16</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;I32&#34;</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#204a87>int32</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;I64&#34;</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#204a87>int64</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;Binary&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87>byte</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;Map&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;Set&#34;</span><span style=color:#000;font-weight:700>:</span>       <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;List&#34;</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;ErrorCode&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87>int32</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#4e9a06>&#34;Info&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;Map&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>                                <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                        <span style=color:#4e9a06>&#34;ID&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87>int64</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>232324</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic>//Note:传入形如 ([]interface{})(nil) 格式的value也会被视为空值进行编码</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=client-usage-2>Client Usage</h4><p>Streaming calls on the client side require cloudwego/kitex >= v0.14.1.</p><h5 id=client-initialization>Client Initialization</h5><p>Note: <strong>Do not</strong> create a new Client for each request (as each client consumes extra resources). It is recommended to create one client for each downstream service when the process starts, or use a Client Pool indexed by the downstream service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Local file idl parsing</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// YOUR_IDL_PATH thrift file path: example ./idl/example.thrift</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// includeDirs: specify include paths, default uses relative path of current file to find includes</span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct map request and return type generic call</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MapThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeaderStreaming</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If the client needs to support streaming generic calls, you need to confirm the streaming call protocol. By default, the generic client generated through the above method uses TTHeaderStreaming for streaming protocols, while non-streaming messages use Framed or TTHeaderFramed. If you need to configure streaming methods to use GRPC protocol without changing the protocol of non-streaming methods, add the following client options:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GRPCStreaming</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h5 id=generic-call-2>Generic Call</h5><p>The request/response or stream message passed in generic calls are map[string]interface{} type. After the generic client is initialized, it provides 4 streaming mode call methods. For detailed streaming usage, see: <a href=/docs/kitex/tutorials/basic-feature/streamx/>StreamX Basic Stream Programming</a>.</p><p><strong>Request</strong>
Type: map[string]interface{}</p><p><strong>Response</strong>
Type: map[string]interface{}</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// uanry</span>
</span></span><span style=display:flex><span><span style=color:#000>resp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ExampleMethod&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;msg&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>// keys should be the same as defined in json tag</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span> <span style=color:#8f5902;font-style:italic>// resp is a map[string]interface{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// client streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ClientStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// server streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ServerStreamingTest&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;msg&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>// keys should be the same as defined in json tag</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// bidi streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BidirectionalStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;BidirectionalStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Detailed usage example: <a href=https://github.com/cloudwego/kitex-tests/blob/main/generic/map/client_test.go>https://github.com/cloudwego/kitex-tests/blob/main/generic/map/client_test.go</a></p><h4 id=server-usage-2>Server Usage</h4><p>For servers using map generic calls with streaming interfaces, please ensure cloudwego/kitex >= v0.15.1.</p><p><strong>Request</strong>
Type: map[string]interface{}</p><p><strong>Response</strong>
Type: map[string]interface{}</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Local file idl parsing</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// YOUR_IDL_PATH thrift file path: e.g. ./idl/example.thrift</span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct map request and return type generic call</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MapThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Old generic call interface, only supports ping pong</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svc</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>GenericServiceImpl</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// v2 generic call interface, supports streaming</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svc</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServerV2</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServiceV2Iface2ServiceV2</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>GenericServiceImplV2</span><span style=color:#000;font-weight:700>{}),</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Run</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// resp is a map[string]interface{}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Detailed usage can be referenced at <a href=https://github.com/cloudwego/kitex-tests/blob/main/generic/map/server.go#L81C6-L81C24>https://github.com/cloudwego/kitex-tests/blob/main/generic/map/server.go#L81C6-L81C24</a></p><h4 id=special-notes---map-generic>Special Notes - Map Generic</h4><ul><li>The response&rsquo;s field id and type will be validated and the corresponding map key will be generated according to the idl&rsquo;s field name. The field id and type here need to be consistent with the idl definition, otherwise it will lead to undefined behavior;</li><li>If you confirm that all map types defined in thrift have string type keys, and you do not want to use map[interface{}]interface{} type parameters to construct/parse messages, you can use MapThriftGenericForJSON to construct generic;</li></ul><p>(Note: Kitex v1.17.<em>~v1.19.</em> versions introduced a bug that caused this interface to fail, see MapThriftGenericForJSON does not take effect)</p><p>For empty structs, generic calls will default to generating an empty map rather than an empty struct, meaning its subfields will not appear in this map. If you need to set subfields in an empty map at the same time, you can use EnableSetFieldsForEmptyStruct.</p><h3 id=json-mapping-generic-call>JSON Mapping Generic Call</h3><p>JSON mapping generic call means that users can directly construct JSON String request parameters or returns according to the specification, and Kitex will complete Thrift encoding and decoding accordingly.</p><p>Note: Kitex now supports higher performance generic call implementation, usage see <a href=../generic-call-dynamicgo/>Generic Call Access DynamicGo Guide</a>.</p><h4 id=json-construction>JSON Construction</h4><p>Unlike MAP generic calls which strictly validate the field names and types constructed by users, JSON generic calls will convert the user&rsquo;s request parameters according to the given IDL, without requiring users to specify explicit types such as int32 or int64.</p><p>For Response, the Field ID and type will be validated, and the corresponding JSON Field will be generated according to the Field Name of the IDL.</p><p>Currently supports Kitex-Thrift and Kitex-Protobuf as downstream for calls</p><h4 id=jsonthrift-generic>JSON&lt;>Thrift Generic</h4><h5 id=type-mapping-1>Type Mapping</h5><p>Golang 与 Thrift IDL 类型映射如下：</p><table><thead><tr><th>Golang Type</th><th>Thrift IDL Type</th><th>Note</th></tr></thead><tbody><tr><td>bool</td><td>bool</td><td></td></tr><tr><td>int8</td><td>i8</td><td></td></tr><tr><td>int16</td><td>i16</td><td></td></tr><tr><td>int32</td><td>i32</td><td></td></tr><tr><td>int64</td><td>i64</td><td></td></tr><tr><td>float64</td><td>double</td><td></td></tr><tr><td>string</td><td>string</td><td></td></tr><tr><td>[]byte</td><td>binary</td><td>binary construction requires base64 encoding</td></tr><tr><td>[]interface{}</td><td>list/set</td><td></td></tr><tr><td>map[interface{}]interface{}</td><td>map</td><td></td></tr><tr><td>map[string]interface{}</td><td>struct</td><td></td></tr><tr><td>int32</td><td>enum</td><td></td></tr></tbody></table><h5 id=data-example-1>Data Example</h5><p>Take the following IDL as an example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=display:flex><span><span style=color:#204a87;font-weight:700>enum</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>SUCCESS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>FAILURE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Map</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ID</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>EchoRequest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Msg</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>i8</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i16</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I16</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I32</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i64</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>I64</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Map</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>set</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Set</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>List</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ErrorCode</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Info</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>255</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Base</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Base</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Construct the request as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;Msg&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;I8&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;I16&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;I32&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;I64&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;Map&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{\&#34;hello\&#34;:\&#34;world\&#34;}&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;Set&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;List&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;ErrorCode&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;Info&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{\&#34;Map\&#34;:\&#34;{\&#34;hello\&#34;:\&#34;world\&#34;}\&#34;, \&#34;ID\&#34;:232324}&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=client-usage-3>Client Usage</h4><p>Streaming calls require cloudwego/kitex >= v0.14.1.</p><h5 id=client-initialization-1>Client Initialization</h5><p>Note: <strong>Do not</strong> create a new Client for each request (as each client consumes extra resources). It is recommended to create one client for each downstream service when the process starts, or use a Client Pool indexed by the downstream service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Local file idl parsing</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// YOUR_IDL_PATH thrift file path: example ./idl/example.thrift</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// includeDirs: specify include paths, default uses relative path of current file to find includes</span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct JSON request and return type generic call</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSONThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>()),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeaderStreaming</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If the client needs to support streaming generic calls, you need to confirm the streaming call protocol. By default, the generic client generated through the above method uses TTHeaderStreaming for streaming protocols, while non-streaming messages use Framed or TTHeaderFramed. If you need to configure streaming methods to use GRPC protocol without changing the protocol of non-streaming methods, add the following client options:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;service&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GRPCStreaming</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h5 id=generic-call-3>Generic Call</h5><p>The request/response or stream message passed in generic calls are JSON string type. After the generic client is initialized, it provides 4 streaming mode call methods. For detailed streaming usage, see: <a href=/docs/kitex/tutorials/basic-feature/streamx/>StreamX Basic Stream Programming</a>.</p><p><strong>Request</strong>
Type: JSON string</p><p><strong>Response</strong>
Type: JSON string</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// unary</span>
</span></span><span style=display:flex><span><span style=color:#000>resp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ExampleMethod&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;{\&#34;Msg\&#34;: \&#34;hello\&#34;}&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// resp is a JSON string</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// client streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ClientStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// server streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ServerStreamingTest&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;{\&#34;Msg\&#34;: \&#34;hello\&#34;}&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// bidi streaming</span>
</span></span><span style=display:flex><span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericCli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BidirectionalStreaming</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;BidirectionalStreamingTest&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Detailed usage example: <a href=https://github.com/cloudwego/kitex-tests/blob/main/generic/streamxjson/generic_test.go>https://github.com/cloudwego/kitex-tests/blob/main/generic/streamxjson/generic_test.go</a></p><h4 id=server-usage-3>Server Usage</h4><p>For servers using json generic calls with streaming interfaces, please ensure cloudwego/kitex >= v0.15.1.</p><p><strong>Request</strong>
Type: JSON string</p><p><strong>Response</strong>
Type: JSON string</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Local file idl parsing</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// YOUR_IDL_PATH thrift file path: e.g. ./idl/example.thrift</span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Construct JSON request and return type generic call</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSONThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Old generic call interface, only supports ping pong</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svc</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>GenericServiceImpl</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// v2 generic call interface, supports streaming</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svc</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServerV2</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServiceV2Iface2ServiceV2</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>GenericServiceImplV2</span><span style=color:#000;font-weight:700>{}),</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Run</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// resp is a JSON string</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Detailed usage can be referenced at <a href=https://github.com/cloudwego/kitex-tests/blob/main/generic/json/server.go#L84>https://github.com/cloudwego/kitex-tests/blob/main/generic/json/server.go#L84</a></p><h4 id=special-notes>Special Notes</h4><p>Since JSON generic currently uses gjson, it will forcibly convert each field of the user&rsquo;s request according to the IDL (<a href=https://github.com/cloudwego/kitex/blob/develop/pkg/generic/thrift/write.go#L130%29>https://github.com/cloudwego/kitex/blob/develop/pkg/generic/thrift/write.go#L130)</a>, so when the user&rsquo;s field type is passed incorrectly, it will be replaced with the default value. For example: &ldquo;test&rdquo; field in IDL requires i64, but request contains {&ldquo;test&rdquo;:&ldquo;abc&rdquo;}, this situation will not report an error now, but will be modified to {&ldquo;test&rdquo;:0}. This problem will be more strictly limited when switching to dynamicgo.</p><p>By setting environment variables, you can choose whether to globally enable using go.tag values as JSON keys, which also applies to Map generic calls.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Use original Key as JSON generic or Map generic call Key, disable the use of go.tag Key</span>
</span></span><span style=display:flex><span><span style=color:#000>KITEX_GENERIC_GOTAG_ALIAS_DISABLED</span> <span style=color:#ce5c00;font-weight:700>=</span> True
</span></span></code></pre></div><p>Starting from <a href=mailto:cloudwego/kitex@v0.12.0>cloudwego/kitex@v0.12.0</a>, go.tag can be disabled through generic.WithGoTagDisabled option. This allows separately specifying whether to disable go.tag annotations for client/server generic calls.</p><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// when you use ThriftFileProvider</span>
</span></span><span style=display:flex><span><span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProviderWithOption</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ThriftIDLProviderOption</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithGoTagDisabled</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>)})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// when you use ThriftContentProvider</span>
</span></span><span style=display:flex><span><span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftContentProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serviceContent</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>includes</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithGoTagDisabled</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// when you use ThriftContentWithAbsIncludePathProvider</span>
</span></span><span style=display:flex><span><span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftContentWithAbsIncludePathProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>includes</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithGoTagDisabled</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h4 id=jsonprotobuf-generic>JSON&lt;>Protobuf Generic</h4><p>Currently only targets KitexProtobuf protocol. Pass in IDL Provider and optional Option parameters, return Protobuf JSON generic call object, Option parameters see Generic Call Access DynamicGo Guide.</p><h5 id=type-mapping-2>Type Mapping</h5><p>Golang 与 Proto IDL 类型映射如下：</p><p>Additionally supports lists and dictionaries in JSON, mapping them to repeated V and map&lt;K,V> in protobuf. Does not support special types in protobuf, such as Enum, oneof.</p><h5 id=example-idl>Example IDL</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=display:flex><span><span style=color:#000>syntax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;proto3&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>api</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#8f5902;font-style:italic>// The greeting service definition.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;api&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>Request</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#204a87;font-weight:700>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>Response</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#204a87;font-weight:700>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>Echo</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>EchoPB</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>Response</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{}</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></span></span></code></pre></div><h5 id=client>Client</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>dproto</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/dynamicgo/proto&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/client/genericclient&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/klog&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/transport&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>serverHostPort</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:9999&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>path</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Create Pb IDL Provider</span>
</span></span><span style=display:flex><span>        <span style=color:#000>dOpts</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dproto</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPbFileProviderWithDynamicGo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>dOpts</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Create Generic client</span>
</span></span><span style=display:flex><span>        <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSONPbGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serverHostPort</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTransportProtocol</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transport</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TTHeader</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientTTHeaderHandler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ClientHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;server_name_for_discovery&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>jReq</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>`{&#34;message&#34;: &#34;hello&#34;}`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// JRsp type is JSON string</span>
</span></span><span style=display:flex><span>        <span style=color:#000>jRsp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;EchoPB&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>jReq</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>klog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CtxInfof</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;genericJsonCall: jRsp(%T) = %s, err = %v&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>jRsp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>jRsp</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=server>Server</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>dproto</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/dynamicgo/proto&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/klog&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/server/genericserver&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/transmeta&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;net&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>serverHostPort</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:9999&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithServiceAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hostPort</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>addr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>_</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResolveTCPAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>hostPort</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithServiceAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>GenericEchoImpl</span> <span style=color:#204a87;font-weight:700>struct</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>GenericEchoImpl</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>GenericCall</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>request</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>response</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>buf</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>request</span><span style=color:#000;font-weight:700>.(</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Option</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>WithServiceAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serverHostPort</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerTTHeaderHandler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithMetaHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>transmeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServerHTTP2Handler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>path</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;./YOUR_IDL_PATH&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>dOpts</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dproto</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPbFileProviderWithDynamicGo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>dOpts</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSONPbGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>opts</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>WithServiceAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serverHostPort</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>svr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>genericserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>GenericEchoImpl</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Run</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#000>klog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=performance-benchmark-comparison>Performance Benchmark Comparison</h3><p>The following test results use complex nested structures as benchmark payloads, with concurrency controlled at 100, server allocated 4 cores Intel(R) Xeon(R) Gold 5118 CPU @ 2.30GHz, benchmark code link.</p><table><thead><tr><th>Generic Type</th><th>TPS</th><th>TP99</th><th>TP999</th><th>Server CPU AVG</th><th>Client CPU AVG</th><th>Throughput differences (compared to non-generic)</th></tr></thead><tbody><tr><td>Non-generic</td><td>147006</td><td>1.60ms</td><td>3.45ms</td><td>391.48</td><td>544.83</td><td>0%</td></tr><tr><td>Map generic</td><td>78104</td><td>3.58ms</td><td>21.88ms</td><td>392.62</td><td>509.70</td><td>-47%</td></tr><tr><td>JSON generic-No dynamicgo</td><td>19647</td><td>21.49ms</td><td>61.52ms</td><td>392.20</td><td>494.30</td><td>-86%</td></tr><tr><td>HTTP generic-No dynamicgo</td><td>136093</td><td>2.57ms</td><td>5.18ms</td><td>369.61</td><td>1329.26</td><td>-8%</td></tr></tbody></table><p>Json / http generic support using dynamicgo for higher performance, the following are performance test results under 2k qps, 100 concurrency, 10k package size. Server allocated 4 cores Intel (R) Xeon (R) Gold 5118 CPU @2.30GHz.</p><table><thead><tr><th>Generic Type</th><th>With dynamicgo</th><th>TPS</th><th>TP99</th><th>TP999</th><th>Throughput differences</th></tr></thead><tbody><tr><td>JSON generic</td><td>no</td><td>2466.90</td><td>141.38ms</td><td>206.25ms</td><td>0%</td></tr><tr><td></td><td>yes</td><td>9179.28</td><td>34.75ms</td><td>80.75ms</td><td>+272%</td></tr><tr><td>HTTP generic</td><td>no</td><td>8338.20</td><td>90.92ms</td><td>139.31ms</td><td>0%</td></tr><tr><td></td><td>yes</td><td>27243.95</td><td>9.57ms</td><td>23.76ms</td><td>+227%</td></tr></tbody></table><p>Note: During the above testing process, map/json generic are enabled simultaneously on client/server, http generic only supports client side so it is only enabled on client side. Since the benchmark only limits the server CPU upper limit, please pay attention to client cpu overhead when comparing results.</p><h3 id=faq>FAQ</h3><p><strong>Q：Do generic calls need to reference IDL?</strong></p><ul><li>Binary stream forwarding: No need</li><li>HTTP/Map/JSON: Need</li></ul><p>Because the request only contains field names, IDL is needed to provide the mapping relationship of &ldquo;field name -> field ID&rdquo;. The serialized thrift binary only contains field IDs.</p><p><strong>Q：Will the framework do corresponding monitoring and reporting when using binary stream forwarding?</strong></p><p>Yes, it will.</p><p><strong>Q: &ldquo;missing version in Thrift Message&rdquo;</strong></p><p>This indicates that the passed buff is not correctly encoded Thrift, please confirm the usage.</p><p>Note: Binary encoding does not encode the original Thrift request parameters (example: api.Request), but rather encapsulates method parameters in XXXArgs (example: api.HelloEchoArgs).</p><p><strong>Q: Does it support protobuf?</strong></p><p>Currently map generic supports it, json generic plans to support it.</p><p><strong>Q：How to check if annotation key is standardized in HTTP generic calls?</strong></p><p>You can use the Parse method under pkg/generic/thrift/parse.go to check, if it&rsquo;s not a key in BAM specification, it will return error.</p><p><strong>Q：Do generic calls support default values defined in idl?</strong></p><p>Kitex map/http/json generic supports setting default values defined in idl when reading, as in the following example idl file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=display:flex><span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BaseElem</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Request</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>double</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>c</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5.1</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>d</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;123&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>list</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BaseElem</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>e</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[{</span><span style=color:#4e9a06>&#34;a&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#000;font-weight:700>}]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>optional</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i32</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BaseElem</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>f</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;a&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#000;font-weight:700>}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>When encoding requests containing the above default values to the peer,</p><ul><li>For map generic, it will automatically add the above field names as keys, default values as values k-v pairs;</li><li>For json generic, it will include k-v pairs with defined default values in the encoded json string;</li><li>For http generic, it will set default values at response annotation fields.</li></ul><p><strong>Q：For fields modified by optional, the generated type carries pointers, does the value of Map generic also need to use pointers?</strong></p><p>No need.</p><p><strong>Q：If multiple services are defined in idl file, how to handle them in generic calls?</strong></p><p>Each generic client/server defaults to using the last service definition, you can specify parsing specific service through the following code:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/kitex/pkg/generic&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>path</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;json_test/idl/example_multi_service.thrift&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>ThriftIDLProviderOption</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>WithIDLServiceName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;ExampleService&#34;</span><span style=color:#000;font-weight:700>)}</span>
</span></span><span style=display:flex><span><span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>NewThriftFileProviderWithOption</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p><strong>Q: Server reports error &ldquo;[ReadString] the string size greater than buf length&rdquo;</strong></p><p>It may be that the client and server have idl differences, such as inconsistent field types.</p><p><strong>Q：map generic call byte type field panics in writeInt8 function</strong></p><pre tabindex=0><code>github.com/cloudwego/kitex/pkg/generic/thrift.writeInt8(...)
        /.../github.com/cloudwego/kitex@v0.4.4/pkg/generic/thrift/write.go:312 +0xb4
</code></pre><p>Reason: thriftgo aligns with apache thrift implementation, will convert byte type fields in IDL to int8 type in go, so old version cloudwego/kitex (&lt;0.6.0) does not have adaptation for byte type in writeInt8.</p><p>Suggestion:</p><ul><li>Client side: Upgrade to new version: cloudwego/kitex >= 0.6.0 (or)</li><li>Keep old version: Use int(byteVal) to assign values to this field when constructing map.</li><li>Server side: Convert the int8 field to byte type (if there are values > 127)</li></ul><p>Note: Converting between byte and int8 will not lose precision.</p><p><strong>Q: binary generic-server: &ldquo;invalid trans buffer in binaryThriftCodec Unmarshal&rdquo; ?</strong></p><p>The binary generic server received packets must have header size, because binary generic does not parse Thrift packets, packets without header size cannot be processed normally.</p><p>Internal services must enable ingress traffic proxy.</p><p>If you encounter this problem, the upstream client needs to configure the transmission protocol framed or ttheader, see how to specify transmission protocol.</p><p><strong>Q：How to inject different generic implementations for different idl services under one server?</strong></p><p>Support all generic call types except BinaryThriftGeneric, BinaryThriftGeneric only supports enabling through genericserver.NewServer or genericserver.NewServerWithServiceInfo.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>runServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ln</span> <span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Listener</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>error</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;idl/tenant.thrift&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MapThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterService</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServiceInfoWithGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>),</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>MapGenericServiceImpl</span><span style=color:#000;font-weight:700>{})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>p</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewThriftFileProvider</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;idl/echo.thrift&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSONThriftGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterService</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>generic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServiceInfoWithGeneric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>),</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>JsonGenericServiceImpl</span><span style=color:#000;font-weight:700>{})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>svr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Run</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
September 29, 2025
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/f3396abf3818920e5c89476d7b76d556b8799c1f>docs: update kitex generic and add kitex proxy docs (#1426) (f3396ab)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Lark aria-label=Lark><a class=text-white target=_blank rel=noopener href="https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=693v2544-2664-4421-b50f-7f1912p745r6" aria-label=Lark><img src=/webfonts/lark.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/CloudWeGo aria-label=Twitter><img src=/webfonts/x-twitter.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cloudwego aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/jceZSE7DsW aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/main.min.9a8648b987db06195f5768f0d7516e8df7c27669e91e383e25c5d07cd6325605.js integrity="sha256-moZIuYfbBhlfV2jw11FujffCdmnpHjg+JcXQfNYyVgU=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/prism-custom.js></script><script src=/js/tabpane-persist.js></script><script src=/js/docsearch.js></script><script type=text/javascript>let siteLang=window.location.pathname.startsWith("/zh/")?"zh":"en";docsearch({appId:"V7I042F992",apiKey:"8380a7ac88106841cb43fb000fa2edb4",indexName:"cloudwego",container:"#docsearch",searchParameters:{hitsPerPage:5,facetFilters:[`lang:${siteLang}`]},transformItems(e){return e.map(e=>({...e,url:e.url.replace("www.cloudwego.io",location.host).replace("https:",location.protocol)}))}})</script><script src=/js/outbound-link.js></script><script src=/js/navScroll.js></script></body></html>